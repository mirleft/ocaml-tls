<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Handshake_common (tls.Tls.Handshake_common)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tls</a> &#x00BB; <a href="../index.html">Tls</a> &#x00BB; Handshake_common</nav><header class="odoc-preamble"><h1>Module <code><span>Tls.Handshake_common</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-src"><a href="#val-src" class="anchor"></a><code><span><span class="keyword">val</span> src : <span class="xref-unresolved">Logs</span>.src</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Log"><a href="#module-Log" class="anchor"></a><code><span><span class="keyword">module</span> Log</span><span> : <span class="xref-unresolved">Logs</span>.LOG</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-trace_cipher"><a href="#val-trace_cipher" class="anchor"></a><code><span><span class="keyword">val</span> trace_cipher : 
  <span><span>[&lt; `AES_128_CCM_SHA256
  <span>| `AES_128_GCM_SHA256</span>
  <span>| `AES_256_GCM_SHA384</span>
  <span>| `CHACHA20_POLY1305_SHA256</span>
  <span>| `DHE_RSA_WITH_3DES_EDE_CBC_SHA</span>
  <span>| `DHE_RSA_WITH_AES_128_CBC_SHA</span>
  <span>| `DHE_RSA_WITH_AES_128_CBC_SHA256</span>
  <span>| `DHE_RSA_WITH_AES_128_CCM</span>
  <span>| `DHE_RSA_WITH_AES_128_GCM_SHA256</span>
  <span>| `DHE_RSA_WITH_AES_256_CBC_SHA</span>
  <span>| `DHE_RSA_WITH_AES_256_CBC_SHA256</span>
  <span>| `DHE_RSA_WITH_AES_256_CCM</span>
  <span>| `DHE_RSA_WITH_AES_256_GCM_SHA384</span>
  <span>| `DHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span>
  <span>| `ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA</span>
  <span>| `ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>
  <span>| `ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</span>
  <span>| `ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>
  <span>| `ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>
  <span>| `ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</span>
  <span>| `ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span>
  <span>| `ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span>
  <span>| `ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>
  <span>| `ECDHE_RSA_WITH_AES_128_CBC_SHA</span>
  <span>| `ECDHE_RSA_WITH_AES_128_CBC_SHA256</span>
  <span>| `ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>
  <span>| `ECDHE_RSA_WITH_AES_256_CBC_SHA</span>
  <span>| `ECDHE_RSA_WITH_AES_256_CBC_SHA384</span>
  <span>| `ECDHE_RSA_WITH_AES_256_GCM_SHA384</span>
  <span>| `ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span>
  <span>| `RSA_WITH_3DES_EDE_CBC_SHA</span>
  <span>| `RSA_WITH_AES_128_CBC_SHA</span>
  <span>| `RSA_WITH_AES_128_CBC_SHA256</span>
  <span>| `RSA_WITH_AES_128_CCM</span>
  <span>| `RSA_WITH_AES_128_GCM_SHA256</span>
  <span>| `RSA_WITH_AES_256_CBC_SHA</span>
  <span>| `RSA_WITH_AES_256_CBC_SHA256</span>
  <span>| `RSA_WITH_AES_256_CCM</span>
  <span>| `RSA_WITH_AES_256_GCM_SHA384</span> AES_128_CCM_SHA256 AES_128_GCM_SHA256 AES_256_GCM_SHA384 CHACHA20_POLY1305_SHA256 ]</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-change_cipher_spec"><a href="#val-change_cipher_spec" class="anchor"></a><code><span><span class="keyword">val</span> change_cipher_spec : <a href="../Packet/index.html#type-content_type">Packet.content_type</a> * <span class="xref-unresolved">Cstruct</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hostname"><a href="#val-hostname" class="anchor"></a><code><span><span class="keyword">val</span> hostname : <span><a href="../Core/index.html#type-client_hello">Core.client_hello</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>[ `host ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-groups"><a href="#val-groups" class="anchor"></a><code><span><span class="keyword">val</span> groups : 
  <span><a href="../Core/index.html#type-client_hello">Core.client_hello</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&gt; `FFDHE2048
  <span>| `FFDHE3072</span>
  <span>| `FFDHE4096</span>
  <span>| `FFDHE6144</span>
  <span>| `FFDHE8192</span>
  <span>| `P256</span>
  <span>| `P384</span>
  <span>| `P521</span>
  <span>| `X25519</span> ]</span>
    list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_matching"><a href="#val-find_matching" class="anchor"></a><code><span><span class="keyword">val</span> find_matching : 
  <span><span><span>[ `host ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span><span class="xref-unresolved">X509</span>.Certificate.t list</span> * <span class="type-var">'a</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">X509</span>.Certificate.t list</span> * <span class="type-var">'a</span>)</span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-agreed_cert"><a href="#val-agreed_cert" class="anchor"></a><code><span><span class="keyword">val</span> agreed_cert : 
  <span><span>[&lt; <span>`Multiple of
       <span><span>(<span><span class="xref-unresolved">X509</span>.Certificate.t list</span>
        * <span>[&gt; <span>`ED25519 of <span class="type-var">'b</span></span>
          <span><span>| `P256</span> of <span class="type-var">'c</span></span>
          <span><span>| `P384</span> of <span class="type-var">'d</span></span>
          <span><span>| `P521</span> of <span class="type-var">'e</span></span>
          <span><span>| `RSA</span> of <span class="type-var">'f</span></span> ]</span> <span class="keyword">as</span> 'a)</span>
         list</span></span>
  <span><span>| `Multiple_default</span> of
    <span>(<span><span class="xref-unresolved">X509</span>.Certificate.t list</span> * <span class="type-var">'g</span>)</span> * <span><span>(<span><span class="xref-unresolved">X509</span>.Certificate.t list</span> * <span class="type-var">'h</span>)</span> list</span></span>
  <span>| `None</span>
  <span><span>| `Single</span> of <span><span class="xref-unresolved">X509</span>.Certificate.t list</span> * <span class="type-var">'g</span></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?f</span>:<span>(<span><span class="xref-unresolved">X509</span>.Certificate.t <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?signature_algorithms</span>:
    <span><span>[&lt; `ECDSA_SECP256R1_SHA1
    <span>| `ECDSA_SECP256R1_SHA256</span>
    <span>| `ECDSA_SECP384R1_SHA384</span>
    <span>| `ECDSA_SECP521R1_SHA512</span>
    <span>| `ED25519</span>
    <span>| `RSA_PKCS1_MD5</span>
    <span>| `RSA_PKCS1_SHA1</span>
    <span>| `RSA_PKCS1_SHA224</span>
    <span>| `RSA_PKCS1_SHA256</span>
    <span>| `RSA_PKCS1_SHA384</span>
    <span>| `RSA_PKCS1_SHA512</span>
    <span>| `RSA_PSS_RSAENC_SHA256</span>
    <span>| `RSA_PSS_RSAENC_SHA384</span>
    <span>| `RSA_PSS_RSAENC_SHA512</span> ECDSA_SECP256R1_SHA1 ECDSA_SECP256R1_SHA256 ECDSA_SECP384R1_SHA384 ECDSA_SECP521R1_SHA512 ED25519 ]</span>
      list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>[ `host ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">X509</span>.Certificate.t list</span> * <span class="type-var">'g</span>,
    <span>[&gt; <span>`Error of
         <span>[&gt; `CouldntSelectCertificate
         <span>| `NoCertificateConfigured</span>
         <span><span>| `NoMatchingCertificateFound</span> of string</span> ]</span></span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_secure_renegotiation"><a href="#val-get_secure_renegotiation" class="anchor"></a><code><span><span class="keyword">val</span> get_secure_renegotiation : 
  <span><span><span>[&gt; <span>`SecureRenegotiation of <span class="type-var">'a</span></span> ]</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_alpn_protocols"><a href="#val-get_alpn_protocols" class="anchor"></a><code><span><span class="keyword">val</span> get_alpn_protocols : <span><a href="../Core/index.html#type-client_hello">Core.client_hello</a> <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-alpn_protocol"><a href="#val-alpn_protocol" class="anchor"></a><code><span><span class="keyword">val</span> alpn_protocol : 
  <span><a href="../Config/index.html#type-config">Config.config</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Core/index.html#type-client_hello">Core.client_hello</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>string option</span>, <span>[&gt; <span>`Fatal of <span>[&gt; `NoApplicationProtocol ]</span></span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_alpn_protocol"><a href="#val-get_alpn_protocol" class="anchor"></a><code><span><span class="keyword">val</span> get_alpn_protocol : <span><a href="../Core/index.html#type-server_hello">Core.server_hello</a> <span class="arrow">&#45;&gt;</span></span> <span>string option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty_common_session_data"><a href="#val-empty_common_session_data" class="anchor"></a><code><span><span class="keyword">val</span> empty_common_session_data : <a href="../State/index.html#type-common_session_data">State.common_session_data</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty_session"><a href="#val-empty_session" class="anchor"></a><code><span><span class="keyword">val</span> empty_session : <a href="../State/index.html#type-session_data">State.session_data</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty_session13"><a href="#val-empty_session13" class="anchor"></a><code><span><span class="keyword">val</span> empty_session13 : <span><a href="../Ciphersuite/index.html#type-ciphersuite13">Ciphersuite.ciphersuite13</a> <span class="arrow">&#45;&gt;</span></span> <a href="../State/index.html#type-session_data13">State.session_data13</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-common_session_data_of_epoch"><a href="#val-common_session_data_of_epoch" class="anchor"></a><code><span><span class="keyword">val</span> common_session_data_of_epoch : 
  <span><a href="../Core/index.html#type-epoch_data">Core.epoch_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../State/index.html#type-common_session_data">State.common_session_data</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../State/index.html#type-common_session_data">State.common_session_data</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-session_of_epoch"><a href="#val-session_of_epoch" class="anchor"></a><code><span><span class="keyword">val</span> session_of_epoch : <span><a href="../Core/index.html#type-epoch_data">Core.epoch_data</a> <span class="arrow">&#45;&gt;</span></span> <a href="../State/index.html#type-session_data">State.session_data</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-session13_of_epoch"><a href="#val-session13_of_epoch" class="anchor"></a><code><span><span class="keyword">val</span> session13_of_epoch : 
  <span><a href="../Ciphersuite/index.html#type-ciphersuite13">Ciphersuite.ciphersuite13</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Core/index.html#type-epoch_data">Core.epoch_data</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../State/index.html#type-session_data13">State.session_data13</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-supported_protocol_version"><a href="#val-supported_protocol_version" class="anchor"></a><code><span><span class="keyword">val</span> supported_protocol_version : 
  <span><span>(<span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span>
   * <span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span> <span class="keyword">as</span> 'a <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'b</span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_client_ext_type"><a href="#val-to_client_ext_type" class="anchor"></a><code><span><span class="keyword">val</span> to_client_ext_type : 
  <span><span>[&lt; <span>`ALPN of <span class="type-var">'a</span></span>
  <span><span>| `Cookie</span> of <span class="type-var">'b</span></span>
  <span><span>| `Draft</span> of <span class="type-var">'c</span></span>
  <span>| `ECPointFormats</span>
  <span>| `EarlyDataIndication</span>
  <span>| `ExtendedMasterSecret</span>
  <span><span>| `Hostname</span> of <span class="type-var">'d</span></span>
  <span><span>| `KeyShare</span> of <span class="type-var">'e</span></span>
  <span><span>| `MaxFragmentLength</span> of <span class="type-var">'f</span></span>
  <span><span>| `Padding</span> of <span class="type-var">'g</span></span>
  <span>| `PostHandshakeAuthentication</span>
  <span><span>| `PreSharedKeys</span> of <span class="type-var">'h</span></span>
  <span><span>| `PskKeyExchangeModes</span> of <span class="type-var">'i</span></span>
  <span><span>| `SecureRenegotiation</span> of <span class="type-var">'j</span></span>
  <span><span>| `SignatureAlgorithms</span> of <span class="type-var">'k</span></span>
  <span><span>| `SupportedGroups</span> of <span class="type-var">'l</span></span>
  <span><span>| `SupportedVersions</span> of <span class="type-var">'m</span></span>
  <span><span>| `UnknownExtension</span> of <span class="type-var">'n</span></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>[&gt; `ALPN
  <span>| `Cookie</span>
  <span>| `Draft</span>
  <span>| `ECPointFormats</span>
  <span>| `EarlyDataIndication</span>
  <span>| `ExtendedMasterSecret</span>
  <span>| `Hostname</span>
  <span>| `KeyShare</span>
  <span>| `MaxFragmentLength</span>
  <span>| `Padding</span>
  <span>| `PostHandshakeAuthentication</span>
  <span>| `PreSharedKey</span>
  <span>| `PskKeyExchangeMode</span>
  <span>| `SecureRenegotiation</span>
  <span>| `SignatureAlgorithms</span>
  <span>| `SupportedGroups</span>
  <span>| `SupportedVersion</span>
  <span>| `UnknownExtension</span> ]</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_server_ext_type"><a href="#val-to_server_ext_type" class="anchor"></a><code><span><span class="keyword">val</span> to_server_ext_type : 
  <span><span>[&lt; <span>`ALPN of <span class="type-var">'a</span></span>
  <span><span>| `Draft</span> of <span class="type-var">'b</span></span>
  <span>| `ECPointFormats</span>
  <span>| `EarlyDataIndication</span>
  <span>| `ExtendedMasterSecret</span>
  <span>| `Hostname</span>
  <span><span>| `KeyShare</span> of <span class="type-var">'c</span></span>
  <span><span>| `MaxFragmentLength</span> of <span class="type-var">'d</span></span>
  <span><span>| `PreSharedKey</span> of <span class="type-var">'e</span></span>
  <span><span>| `SecureRenegotiation</span> of <span class="type-var">'f</span></span>
  <span><span>| `SelectedVersion</span> of <span class="type-var">'g</span></span>
  <span><span>| `UnknownExtension</span> of <span class="type-var">'h</span></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>[&gt; `ALPN
  <span>| `Draft</span>
  <span>| `ECPointFormats</span>
  <span>| `EarlyDataIndication</span>
  <span>| `ExtendedMasterSecret</span>
  <span>| `Hostname</span>
  <span>| `KeyShare</span>
  <span>| `MaxFragmentLength</span>
  <span>| `PreSharedKey</span>
  <span>| `SecureRenegotiation</span>
  <span>| `SupportedVersion</span>
  <span>| `UnknownExtension</span> ]</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-extension_types"><a href="#val-extension_types" class="anchor"></a><code><span><span class="keyword">val</span> extension_types : 
  <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>[&gt; `UnknownExtension ]</span> <span class="keyword">as</span> 'b)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'c</span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-server_exts_subset_of_client"><a href="#val-server_exts_subset_of_client" class="anchor"></a><code><span><span class="keyword">val</span> server_exts_subset_of_client : 
  <span><span><span>[&lt; <span>`ALPN of <span class="type-var">'a</span></span>
  <span><span>| `Draft</span> of <span class="type-var">'b</span></span>
  <span>| `ECPointFormats</span>
  <span>| `EarlyDataIndication</span>
  <span>| `ExtendedMasterSecret</span>
  <span>| `Hostname</span>
  <span><span>| `KeyShare</span> of <span class="type-var">'c</span></span>
  <span><span>| `MaxFragmentLength</span> of <span class="type-var">'d</span></span>
  <span><span>| `PreSharedKey</span> of <span class="type-var">'e</span></span>
  <span><span>| `SecureRenegotiation</span> of <span class="type-var">'f</span></span>
  <span><span>| `SelectedVersion</span> of <span class="type-var">'g</span></span>
  <span><span>| `UnknownExtension</span> of <span class="type-var">'h</span></span> ]</span>
    list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>[&lt; <span>`ALPN of <span class="type-var">'i</span></span>
  <span><span>| `Cookie</span> of <span class="type-var">'j</span></span>
  <span><span>| `Draft</span> of <span class="type-var">'k</span></span>
  <span>| `ECPointFormats</span>
  <span>| `EarlyDataIndication</span>
  <span>| `ExtendedMasterSecret</span>
  <span><span>| `Hostname</span> of <span class="type-var">'l</span></span>
  <span><span>| `KeyShare</span> of <span class="type-var">'m</span></span>
  <span><span>| `MaxFragmentLength</span> of <span class="type-var">'n</span></span>
  <span><span>| `Padding</span> of <span class="type-var">'o</span></span>
  <span>| `PostHandshakeAuthentication</span>
  <span><span>| `PreSharedKeys</span> of <span class="type-var">'p</span></span>
  <span><span>| `PskKeyExchangeModes</span> of <span class="type-var">'q</span></span>
  <span><span>| `SecureRenegotiation</span> of <span class="type-var">'r</span></span>
  <span><span>| `SignatureAlgorithms</span> of <span class="type-var">'s</span></span>
  <span><span>| `SupportedGroups</span> of <span class="type-var">'t</span></span>
  <span><span>| `SupportedVersions</span> of <span class="type-var">'u</span></span>
  <span><span>| `UnknownExtension</span> of <span class="type-var">'v</span></span> ]</span>
    list</span> <span class="arrow">&#45;&gt;</span></span>
  bool</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Group"><a href="#module-Group" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Group/index.html">Group</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-GroupSet"><a href="#module-GroupSet" class="anchor"></a><code><span><span class="keyword">module</span> <a href="GroupSet/index.html">GroupSet</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_list"><a href="#val-of_list" class="anchor"></a><code><span><span class="keyword">val</span> of_list : <span><span><a href="GroupSet/index.html#type-elt">GroupSet.elt</a> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="GroupSet/index.html#type-t">GroupSet.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-client_hello_valid"><a href="#val-client_hello_valid" class="anchor"></a><code><span><span class="keyword">val</span> client_hello_valid : 
  <span><span>[&lt; `SSL_3 <span>| `TLS_1_0</span> <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> <span><span>| `TLS_1_X</span> of <span class="type-var">'a</span></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Core/index.html#type-client_hello">Core.client_hello</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(unit,
    <span>[&gt; `EmptyCiphersuites
    <span><span>| `NoGoodSignatureAlgorithms</span> of <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></span>
    <span>| `NoKeyShareExtension</span>
    <span>| `NoSignatureAlgorithmsExtension</span>
    <span><span>| `NoSupportedCiphersuite</span> of <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span>
    <span>| `NoSupportedGroupExtension</span>
    <span><span>| `NotSetExtension</span> of <span><a href="../Core/index.html#type-client_extension">Core.client_extension</a> list</span></span>
    <span><span>| `NotSetKeyShare</span> of <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="xref-unresolved">Cstruct</span>.t)</span> list</span></span>
    <span><span>| `NotSetSupportedGroup</span> of <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span></span>
    <span><span>| `NotSubsetKeyShareSupportedGroup</span> of
      <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span> * <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="xref-unresolved">Cstruct</span>.t)</span> list</span></span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-server_hello_valid"><a href="#val-server_hello_valid" class="anchor"></a><code><span><span class="keyword">val</span> server_hello_valid : <span><a href="../Core/index.html#type-server_hello">Core.server_hello</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-to_sign_1_3"><a href="#val-to_sign_1_3" class="anchor"></a><code><span><span class="keyword">val</span> to_sign_1_3 : <span><span>string option</span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cstruct</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-signature"><a href="#val-signature" class="anchor"></a><code><span><span class="keyword">val</span> signature : 
  <span><span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?context_string</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">X509</span>.Private_key.t <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="xref-unresolved">Cstruct</span>.t,
    <span>[&gt; <span>`Error of
         <span>[&gt; <span>`NoConfiguredSignatureAlgorithm of <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></span> ]</span></span>
    <span><span>| `Fatal</span> of <span>[&gt; `KeyTooSmall <span><span>| `SigningFailed</span> of string</span> ]</span></span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-peer_key"><a href="#val-peer_key" class="anchor"></a><code><span><span class="keyword">val</span> peer_key : 
  <span><span><span class="xref-unresolved">X509</span>.Certificate.t option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="xref-unresolved">X509</span>.Public_key.t, <span>[&gt; <span>`Fatal of <span>[&gt; `NoCertificateReceived ]</span></span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-verify_digitally_signed"><a href="#val-verify_digitally_signed" class="anchor"></a><code><span><span class="keyword">val</span> verify_digitally_signed : 
  <span><span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?context_string</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Cstruct</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">X509</span>.Certificate.t option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(unit,
    <span>[&gt; <span>`Error of
         <span>[&gt; <span>`NoConfiguredSignatureAlgorithm of <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></span> ]</span></span>
    <span><span>| `Fatal</span> of
      <span>[&gt; `NoCertificateReceived
      <span><span>| `ReaderError</span> of <a href="../Reader/index.html#type-error">Reader.error</a></span>
      <span><span>| `SignatureVerificationFailed</span> of string</span> ]</span></span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-validate_chain"><a href="#val-validate_chain" class="anchor"></a><code><span><span class="keyword">val</span> validate_chain : 
  <span><span><span>(<span><span class="optlabel">?ip</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
    <span><span class="label">host</span>:<span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span>
    <span><span><span class="xref-unresolved">X509</span>.Certificate.t list</span> <span class="arrow">&#45;&gt;</span></span>
    <span><span>(<span><span>(<span><span class="type-var">'c</span> list</span> * <span class="type-var">'d</span>)</span> option</span>, <span class="type-var">'e</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span>)</span>
    option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="xref-unresolved">Cstruct</span>.t list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'f</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span class="xref-unresolved">X509</span>.Certificate.t option</span> * <span><span class="xref-unresolved">X509</span>.Certificate.t list</span> * <span><span class="type-var">'c</span> list</span> * <span><span class="type-var">'g</span> option</span>,
    <span>[&gt; <span>`Error of <span>[&gt; <span>`AuthenticationFailure of <span class="type-var">'e</span></span> ]</span></span>
    <span><span>| `Fatal</span> of <span>[&gt; `BadCertificateChain <span>| `KeyTooSmall</span> ]</span></span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-output_key_update"><a href="#val-output_key_update" class="anchor"></a><code><span><span class="keyword">val</span> output_key_update : 
  <span><span class="label">request</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../State/index.html#type-state">State.state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../State/index.html#type-state">State.state</a> * <span>(<a href="../Packet/index.html#type-content_type">Packet.content_type</a> * <span class="xref-unresolved">Cstruct</span>.t)</span>,
    <span>[&gt; <span>`Fatal of <span>[&gt; `InvalidSession ]</span></span> ]</span>)</span>
    <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div></div></body></html>
