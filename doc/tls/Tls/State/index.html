<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>State (tls.Tls.State)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tls</a> &#x00BB; <a href="../index.html">Tls</a> &#x00BB; State</nav><header class="odoc-preamble"><h1>Module <code><span>Tls.State</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-hmac_key"><a href="#type-hmac_key" class="anchor"></a><code><span><span class="keyword">type</span> hmac_key</span><span> = <span class="xref-unresolved">Cstruct</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-iv_mode"><a href="#type-iv_mode" class="anchor"></a><code><span><span class="keyword">type</span> iv_mode</span><span> = </span></code><ol><li id="type-iv_mode.Iv" class="def variant constructor anchored"><a href="#type-iv_mode.Iv" class="anchor"></a><code><span>| </span><span><span class="constructor">Iv</span> <span class="keyword">of</span> <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-iv_mode.Random_iv" class="def variant constructor anchored"><a href="#type-iv_mode.Random_iv" class="anchor"></a><code><span>| </span><span><span class="constructor">Random_iv</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-cbc_cipher"><a href="#type-cbc_cipher" class="anchor"></a><code><span><span class="keyword">type</span> <span>'k cbc_cipher</span></span><span> =
  <span>(<span class="keyword">module</span> <span class="xref-unresolved">Mirage_crypto</span>.Cipher_block.S.CBC
  <span class="keyword">with</span> <span class="keyword">type</span> <span class="xref-unresolved">key</span> = <span class="type-var">'k</span>)</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-cbc_state"><a href="#type-cbc_state" class="anchor"></a><code><span><span class="keyword">type</span> <span>'k cbc_state</span></span><span> = </span><span>{</span></code><ol><li id="type-cbc_state.cipher" class="def record field anchored"><a href="#type-cbc_state.cipher" class="anchor"></a><code><span>cipher : <span><span class="type-var">'k</span> <a href="#type-cbc_cipher">cbc_cipher</a></span>;</span></code></li><li id="type-cbc_state.cipher_secret" class="def record field anchored"><a href="#type-cbc_state.cipher_secret" class="anchor"></a><code><span>cipher_secret : <span class="type-var">'k</span>;</span></code></li><li id="type-cbc_state.iv_mode" class="def record field anchored"><a href="#type-cbc_state.iv_mode" class="anchor"></a><code><span>iv_mode : <a href="#type-iv_mode">iv_mode</a>;</span></code></li><li id="type-cbc_state.hmac" class="def record field anchored"><a href="#type-cbc_state.hmac" class="anchor"></a><code><span>hmac : <span class="xref-unresolved">Mirage_crypto</span>.Hash.hash;</span></code></li><li id="type-cbc_state.hmac_secret" class="def record field anchored"><a href="#type-cbc_state.hmac_secret" class="anchor"></a><code><span>hmac_secret : <a href="#type-hmac_key">hmac_key</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-nonce"><a href="#type-nonce" class="anchor"></a><code><span><span class="keyword">type</span> nonce</span><span> = <span class="xref-unresolved">Cstruct</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-aead_cipher"><a href="#type-aead_cipher" class="anchor"></a><code><span><span class="keyword">type</span> <span>'k aead_cipher</span></span><span> = <span>(<span class="keyword">module</span> <span class="xref-unresolved">Mirage_crypto</span>.AEAD <span class="keyword">with</span> <span class="keyword">type</span> <span class="xref-unresolved">key</span> = <span class="type-var">'k</span>)</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-aead_state"><a href="#type-aead_state" class="anchor"></a><code><span><span class="keyword">type</span> <span>'k aead_state</span></span><span> = </span><span>{</span></code><ol><li id="type-aead_state.cipher" class="def record field anchored"><a href="#type-aead_state.cipher" class="anchor"></a><code><span>cipher : <span><span class="type-var">'k</span> <a href="#type-aead_cipher">aead_cipher</a></span>;</span></code></li><li id="type-aead_state.cipher_secret" class="def record field anchored"><a href="#type-aead_state.cipher_secret" class="anchor"></a><code><span>cipher_secret : <span class="type-var">'k</span>;</span></code></li><li id="type-aead_state.nonce" class="def record field anchored"><a href="#type-aead_state.nonce" class="anchor"></a><code><span>nonce : <a href="#type-nonce">nonce</a>;</span></code></li><li id="type-aead_state.explicit_nonce" class="def record field anchored"><a href="#type-aead_state.explicit_nonce" class="anchor"></a><code><span>explicit_nonce : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-cipher_st"><a href="#type-cipher_st" class="anchor"></a><code><span><span class="keyword">type</span> cipher_st</span><span> = </span></code><ol><li id="type-cipher_st.CBC" class="def variant constructor anchored"><a href="#type-cipher_st.CBC" class="anchor"></a><code><span>| </span><span><span class="constructor">CBC</span> : <span><span class="type-var">'k</span> <a href="#type-cbc_state">cbc_state</a></span> <span class="arrow">&#45;&gt;</span> <a href="#type-cipher_st">cipher_st</a></span></code></li><li id="type-cipher_st.AEAD" class="def variant constructor anchored"><a href="#type-cipher_st.AEAD" class="anchor"></a><code><span>| </span><span><span class="constructor">AEAD</span> : <span><span class="type-var">'k</span> <a href="#type-aead_state">aead_state</a></span> <span class="arrow">&#45;&gt;</span> <a href="#type-cipher_st">cipher_st</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-crypto_context"><a href="#type-crypto_context" class="anchor"></a><code><span><span class="keyword">type</span> crypto_context</span><span> = </span><span>{</span></code><ol><li id="type-crypto_context.sequence" class="def record field anchored"><a href="#type-crypto_context.sequence" class="anchor"></a><code><span>sequence : int64;</span></code></li><li id="type-crypto_context.cipher_st" class="def record field anchored"><a href="#type-crypto_context.cipher_st" class="anchor"></a><code><span>cipher_st : <a href="#type-cipher_st">cipher_st</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-hs_log"><a href="#type-hs_log" class="anchor"></a><code><span><span class="keyword">type</span> hs_log</span><span> = <span><span class="xref-unresolved">Cstruct</span>.t list</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-dh_secret"><a href="#type-dh_secret" class="anchor"></a><code><span><span class="keyword">type</span> dh_secret</span><span> = </span><span>[ </span></code><ol><li id="type-dh_secret.Finite_field" class="def variant constructor anchored"><a href="#type-dh_secret.Finite_field" class="anchor"></a><code><span>| </span><span>`Finite_field <span class="keyword">of</span> <span class="xref-unresolved">Mirage_crypto_pk</span>.Dh.secret</span></code></li><li id="type-dh_secret.P256" class="def variant constructor anchored"><a href="#type-dh_secret.P256" class="anchor"></a><code><span>| </span><span>`P256 <span class="keyword">of</span> <span class="xref-unresolved">Mirage_crypto_ec</span>.P256.Dh.secret</span></code></li><li id="type-dh_secret.P384" class="def variant constructor anchored"><a href="#type-dh_secret.P384" class="anchor"></a><code><span>| </span><span>`P384 <span class="keyword">of</span> <span class="xref-unresolved">Mirage_crypto_ec</span>.P384.Dh.secret</span></code></li><li id="type-dh_secret.P521" class="def variant constructor anchored"><a href="#type-dh_secret.P521" class="anchor"></a><code><span>| </span><span>`P521 <span class="keyword">of</span> <span class="xref-unresolved">Mirage_crypto_ec</span>.P521.Dh.secret</span></code></li><li id="type-dh_secret.X25519" class="def variant constructor anchored"><a href="#type-dh_secret.X25519" class="anchor"></a><code><span>| </span><span>`X25519 <span class="keyword">of</span> <span class="xref-unresolved">Mirage_crypto_ec</span>.X25519.secret</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-reneg_params"><a href="#type-reneg_params" class="anchor"></a><code><span><span class="keyword">type</span> reneg_params</span><span> = <span class="xref-unresolved">Cstruct</span>.t * <span class="xref-unresolved">Cstruct</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-common_session_data"><a href="#type-common_session_data" class="anchor"></a><code><span><span class="keyword">type</span> common_session_data</span><span> = </span><span>{</span></code><ol><li id="type-common_session_data.server_random" class="def record field anchored"><a href="#type-common_session_data.server_random" class="anchor"></a><code><span>server_random : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-common_session_data.client_random" class="def record field anchored"><a href="#type-common_session_data.client_random" class="anchor"></a><code><span>client_random : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-common_session_data.peer_certificate_chain" class="def record field anchored"><a href="#type-common_session_data.peer_certificate_chain" class="anchor"></a><code><span>peer_certificate_chain : <span><span class="xref-unresolved">X509</span>.Certificate.t list</span>;</span></code></li><li id="type-common_session_data.peer_certificate" class="def record field anchored"><a href="#type-common_session_data.peer_certificate" class="anchor"></a><code><span>peer_certificate : <span><span class="xref-unresolved">X509</span>.Certificate.t option</span>;</span></code></li><li id="type-common_session_data.trust_anchor" class="def record field anchored"><a href="#type-common_session_data.trust_anchor" class="anchor"></a><code><span>trust_anchor : <span><span class="xref-unresolved">X509</span>.Certificate.t option</span>;</span></code></li><li id="type-common_session_data.received_certificates" class="def record field anchored"><a href="#type-common_session_data.received_certificates" class="anchor"></a><code><span>received_certificates : <span><span class="xref-unresolved">X509</span>.Certificate.t list</span>;</span></code></li><li id="type-common_session_data.own_certificate" class="def record field anchored"><a href="#type-common_session_data.own_certificate" class="anchor"></a><code><span>own_certificate : <span><span class="xref-unresolved">X509</span>.Certificate.t list</span>;</span></code></li><li id="type-common_session_data.own_private_key" class="def record field anchored"><a href="#type-common_session_data.own_private_key" class="anchor"></a><code><span>own_private_key : <span><span class="xref-unresolved">X509</span>.Private_key.t option</span>;</span></code></li><li id="type-common_session_data.own_name" class="def record field anchored"><a href="#type-common_session_data.own_name" class="anchor"></a><code><span>own_name : <span><span><span>[ `host ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> option</span>;</span></code></li><li id="type-common_session_data.client_auth" class="def record field anchored"><a href="#type-common_session_data.client_auth" class="anchor"></a><code><span>client_auth : bool;</span></code></li><li id="type-common_session_data.master_secret" class="def record field anchored"><a href="#type-common_session_data.master_secret" class="anchor"></a><code><span>master_secret : <a href="../Core/index.html#type-master_secret">Core.master_secret</a>;</span></code></li><li id="type-common_session_data.alpn_protocol" class="def record field anchored"><a href="#type-common_session_data.alpn_protocol" class="anchor"></a><code><span>alpn_protocol : <span>string option</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-session_data"><a href="#type-session_data" class="anchor"></a><code><span><span class="keyword">type</span> session_data</span><span> = </span><span>{</span></code><ol><li id="type-session_data.common_session_data" class="def record field anchored"><a href="#type-session_data.common_session_data" class="anchor"></a><code><span>common_session_data : <a href="#type-common_session_data">common_session_data</a>;</span></code></li><li id="type-session_data.client_version" class="def record field anchored"><a href="#type-session_data.client_version" class="anchor"></a><code><span>client_version : <a href="../Core/index.html#type-tls_any_version">Core.tls_any_version</a>;</span></code></li><li id="type-session_data.ciphersuite" class="def record field anchored"><a href="#type-session_data.ciphersuite" class="anchor"></a><code><span>ciphersuite : <a href="../Ciphersuite/index.html#type-ciphersuite">Ciphersuite.ciphersuite</a>;</span></code></li><li id="type-session_data.group" class="def record field anchored"><a href="#type-session_data.group" class="anchor"></a><code><span>group : <span><a href="../Core/index.html#type-group">Core.group</a> option</span>;</span></code></li><li id="type-session_data.renegotiation" class="def record field anchored"><a href="#type-session_data.renegotiation" class="anchor"></a><code><span>renegotiation : <a href="#type-reneg_params">reneg_params</a>;</span></code></li><li id="type-session_data.session_id" class="def record field anchored"><a href="#type-session_data.session_id" class="anchor"></a><code><span>session_id : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-session_data.extended_ms" class="def record field anchored"><a href="#type-session_data.extended_ms" class="anchor"></a><code><span>extended_ms : bool;</span></code></li><li id="type-session_data.tls_unique" class="def record field anchored"><a href="#type-session_data.tls_unique" class="anchor"></a><code><span>tls_unique : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-server_handshake_state"><a href="#type-server_handshake_state" class="anchor"></a><code><span><span class="keyword">type</span> server_handshake_state</span><span> = </span></code><ol><li id="type-server_handshake_state.AwaitClientHello" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientHello" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientHello</span></span></code></li><li id="type-server_handshake_state.AwaitClientHelloRenegotiate" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientHelloRenegotiate" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientHelloRenegotiate</span></span></code></li><li id="type-server_handshake_state.AwaitClientCertificate_RSA" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientCertificate_RSA" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientCertificate_RSA</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientCertificate_DHE" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientCertificate_DHE" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientCertificate_DHE</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-dh_secret">dh_secret</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientKeyExchange_RSA" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientKeyExchange_RSA" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientKeyExchange_RSA</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientKeyExchange_DHE" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientKeyExchange_DHE" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientKeyExchange_DHE</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-dh_secret">dh_secret</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientCertificateVerify" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientCertificateVerify" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientCertificateVerify</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientChangeCipherSpec" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientChangeCipherSpec" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientChangeCipherSpec</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientChangeCipherSpecResume" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientChangeCipherSpecResume" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientChangeCipherSpecResume</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientFinished" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientFinished" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientFinished</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.AwaitClientFinishedResume" class="def variant constructor anchored"><a href="#type-server_handshake_state.AwaitClientFinishedResume" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientFinishedResume</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <span class="xref-unresolved">Cstruct</span>.t * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-server_handshake_state.Established" class="def variant constructor anchored"><a href="#type-server_handshake_state.Established" class="anchor"></a><code><span>| </span><span><span class="constructor">Established</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-client_handshake_state"><a href="#type-client_handshake_state" class="anchor"></a><code><span><span class="keyword">type</span> client_handshake_state</span><span> = </span></code><ol><li id="type-client_handshake_state.ClientInitial" class="def variant constructor anchored"><a href="#type-client_handshake_state.ClientInitial" class="anchor"></a><code><span>| </span><span><span class="constructor">ClientInitial</span></span></code></li><li id="type-client_handshake_state.AwaitServerHello" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerHello" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerHello</span> <span class="keyword">of</span> <a href="../Core/index.html#type-client_hello">Core.client_hello</a> * <span><span>(<a href="../Core/index.html#type-group">Core.group</a> * <a href="#type-dh_secret">dh_secret</a>)</span> list</span> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitServerHelloRenegotiate" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerHelloRenegotiate" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerHelloRenegotiate</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="../Core/index.html#type-client_hello">Core.client_hello</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitCertificate_RSA" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitCertificate_RSA" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitCertificate_RSA</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitCertificate_DHE" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitCertificate_DHE" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitCertificate_DHE</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitServerKeyExchange_DHE" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerKeyExchange_DHE" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerKeyExchange_DHE</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitCertificateRequestOrServerHelloDone" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitCertificateRequestOrServerHelloDone" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitCertificateRequestOrServerHelloDone</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitServerHelloDone" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerHelloDone" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerHelloDone</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a>
  * <span><span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitServerChangeCipherSpec" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerChangeCipherSpec" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerChangeCipherSpec</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitServerChangeCipherSpecResume" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerChangeCipherSpecResume" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerChangeCipherSpecResume</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitServerFinished" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerFinished" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerFinished</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <span class="xref-unresolved">Cstruct</span>.t * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.AwaitServerFinishedResume" class="def variant constructor anchored"><a href="#type-client_handshake_state.AwaitServerFinishedResume" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerFinishedResume</span> <span class="keyword">of</span> <a href="#type-session_data">session_data</a> * <a href="#type-hs_log">hs_log</a></span></code></li><li id="type-client_handshake_state.Established" class="def variant constructor anchored"><a href="#type-client_handshake_state.Established" class="anchor"></a><code><span>| </span><span><span class="constructor">Established</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-kdf"><a href="#type-kdf" class="anchor"></a><code><span><span class="keyword">type</span> kdf</span><span> = </span><span>{</span></code><ol><li id="type-kdf.secret" class="def record field anchored"><a href="#type-kdf.secret" class="anchor"></a><code><span>secret : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-kdf.cipher" class="def record field anchored"><a href="#type-kdf.cipher" class="anchor"></a><code><span>cipher : <a href="../Ciphersuite/index.html#type-ciphersuite13">Ciphersuite.ciphersuite13</a>;</span></code></li><li id="type-kdf.hash" class="def record field anchored"><a href="#type-kdf.hash" class="anchor"></a><code><span>hash : <span class="xref-unresolved">Mirage_crypto</span>.Hash.hash;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-session_data13"><a href="#type-session_data13" class="anchor"></a><code><span><span class="keyword">type</span> session_data13</span><span> = </span><span>{</span></code><ol><li id="type-session_data13.common_session_data13" class="def record field anchored"><a href="#type-session_data13.common_session_data13" class="anchor"></a><code><span>common_session_data13 : <a href="#type-common_session_data">common_session_data</a>;</span></code></li><li id="type-session_data13.ciphersuite13" class="def record field anchored"><a href="#type-session_data13.ciphersuite13" class="anchor"></a><code><span>ciphersuite13 : <a href="../Ciphersuite/index.html#type-ciphersuite13">Ciphersuite.ciphersuite13</a>;</span></code></li><li id="type-session_data13.master_secret" class="def record field anchored"><a href="#type-session_data13.master_secret" class="anchor"></a><code><span>master_secret : <a href="#type-kdf">kdf</a>;</span></code></li><li id="type-session_data13.exporter_master_secret" class="def record field anchored"><a href="#type-session_data13.exporter_master_secret" class="anchor"></a><code><span>exporter_master_secret : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-session_data13.resumption_secret" class="def record field anchored"><a href="#type-session_data13.resumption_secret" class="anchor"></a><code><span>resumption_secret : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-session_data13.state" class="def record field anchored"><a href="#type-session_data13.state" class="anchor"></a><code><span>state : <a href="../Core/index.html#type-epoch_state">Core.epoch_state</a>;</span></code></li><li id="type-session_data13.resumed" class="def record field anchored"><a href="#type-session_data13.resumed" class="anchor"></a><code><span>resumed : bool;</span></code></li><li id="type-session_data13.client_app_secret" class="def record field anchored"><a href="#type-session_data13.client_app_secret" class="anchor"></a><code><span>client_app_secret : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-session_data13.server_app_secret" class="def record field anchored"><a href="#type-session_data13.server_app_secret" class="anchor"></a><code><span>server_app_secret : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-client13_handshake_state"><a href="#type-client13_handshake_state" class="anchor"></a><code><span><span class="keyword">type</span> client13_handshake_state</span><span> = </span></code><ol><li id="type-client13_handshake_state.AwaitServerHello13" class="def variant constructor anchored"><a href="#type-client13_handshake_state.AwaitServerHello13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerHello13</span> <span class="keyword">of</span> <a href="../Core/index.html#type-client_hello">Core.client_hello</a>
  * <span><span>(<a href="../Core/index.html#type-group">Core.group</a> * <a href="#type-dh_secret">dh_secret</a>)</span> list</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-client13_handshake_state.AwaitServerEncryptedExtensions13" class="def variant constructor anchored"><a href="#type-client13_handshake_state.AwaitServerEncryptedExtensions13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerEncryptedExtensions13</span> <span class="keyword">of</span> <a href="#type-session_data13">session_data13</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-client13_handshake_state.AwaitServerCertificateRequestOrCertificate13" class="def variant constructor anchored"><a href="#type-client13_handshake_state.AwaitServerCertificateRequestOrCertificate13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerCertificateRequestOrCertificate13</span> <span class="keyword">of</span> <a href="#type-session_data13">session_data13</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-client13_handshake_state.AwaitServerCertificate13" class="def variant constructor anchored"><a href="#type-client13_handshake_state.AwaitServerCertificate13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerCertificate13</span> <span class="keyword">of</span> <a href="#type-session_data13">session_data13</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span><span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-client13_handshake_state.AwaitServerCertificateVerify13" class="def variant constructor anchored"><a href="#type-client13_handshake_state.AwaitServerCertificateVerify13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerCertificateVerify13</span> <span class="keyword">of</span> <a href="#type-session_data13">session_data13</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span><span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-client13_handshake_state.AwaitServerFinished13" class="def variant constructor anchored"><a href="#type-client13_handshake_state.AwaitServerFinished13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitServerFinished13</span> <span class="keyword">of</span> <a href="#type-session_data13">session_data13</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span class="xref-unresolved">Cstruct</span>.t
  * <span><span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-client13_handshake_state.Established13" class="def variant constructor anchored"><a href="#type-client13_handshake_state.Established13" class="anchor"></a><code><span>| </span><span><span class="constructor">Established13</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-server13_handshake_state"><a href="#type-server13_handshake_state" class="anchor"></a><code><span><span class="keyword">type</span> server13_handshake_state</span><span> = </span></code><ol><li id="type-server13_handshake_state.AwaitClientHelloHRR13" class="def variant constructor anchored"><a href="#type-server13_handshake_state.AwaitClientHelloHRR13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientHelloHRR13</span></span></code></li><li id="type-server13_handshake_state.AwaitClientCertificate13" class="def variant constructor anchored"><a href="#type-server13_handshake_state.AwaitClientCertificate13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientCertificate13</span> <span class="keyword">of</span> <a href="#type-session_data13">session_data13</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-crypto_context">crypto_context</a>
  * <span><a href="../Core/index.html#type-session_ticket">Core.session_ticket</a> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-server13_handshake_state.AwaitClientCertificateVerify13" class="def variant constructor anchored"><a href="#type-server13_handshake_state.AwaitClientCertificateVerify13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientCertificateVerify13</span> <span class="keyword">of</span> <a href="#type-session_data13">session_data13</a>
  * <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-crypto_context">crypto_context</a>
  * <span><a href="../Core/index.html#type-session_ticket">Core.session_ticket</a> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-server13_handshake_state.AwaitClientFinished13" class="def variant constructor anchored"><a href="#type-server13_handshake_state.AwaitClientFinished13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitClientFinished13</span> <span class="keyword">of</span> <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-crypto_context">crypto_context</a>
  * <span><a href="../Core/index.html#type-session_ticket">Core.session_ticket</a> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-server13_handshake_state.AwaitEndOfEarlyData13" class="def variant constructor anchored"><a href="#type-server13_handshake_state.AwaitEndOfEarlyData13" class="anchor"></a><code><span>| </span><span><span class="constructor">AwaitEndOfEarlyData13</span> <span class="keyword">of</span> <span class="xref-unresolved">Cstruct</span>.t
  * <a href="#type-crypto_context">crypto_context</a>
  * <a href="#type-crypto_context">crypto_context</a>
  * <span><a href="../Core/index.html#type-session_ticket">Core.session_ticket</a> option</span>
  * <span class="xref-unresolved">Cstruct</span>.t</span></code></li><li id="type-server13_handshake_state.Established13" class="def variant constructor anchored"><a href="#type-server13_handshake_state.Established13" class="anchor"></a><code><span>| </span><span><span class="constructor">Established13</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-handshake_machina_state"><a href="#type-handshake_machina_state" class="anchor"></a><code><span><span class="keyword">type</span> handshake_machina_state</span><span> = </span></code><ol><li id="type-handshake_machina_state.Client" class="def variant constructor anchored"><a href="#type-handshake_machina_state.Client" class="anchor"></a><code><span>| </span><span><span class="constructor">Client</span> <span class="keyword">of</span> <a href="#type-client_handshake_state">client_handshake_state</a></span></code></li><li id="type-handshake_machina_state.Server" class="def variant constructor anchored"><a href="#type-handshake_machina_state.Server" class="anchor"></a><code><span>| </span><span><span class="constructor">Server</span> <span class="keyword">of</span> <a href="#type-server_handshake_state">server_handshake_state</a></span></code></li><li id="type-handshake_machina_state.Client13" class="def variant constructor anchored"><a href="#type-handshake_machina_state.Client13" class="anchor"></a><code><span>| </span><span><span class="constructor">Client13</span> <span class="keyword">of</span> <a href="#type-client13_handshake_state">client13_handshake_state</a></span></code></li><li id="type-handshake_machina_state.Server13" class="def variant constructor anchored"><a href="#type-handshake_machina_state.Server13" class="anchor"></a><code><span>| </span><span><span class="constructor">Server13</span> <span class="keyword">of</span> <a href="#type-server13_handshake_state">server13_handshake_state</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-handshake_state"><a href="#type-handshake_state" class="anchor"></a><code><span><span class="keyword">type</span> handshake_state</span><span> = </span><span>{</span></code><ol><li id="type-handshake_state.session" class="def record field anchored"><a href="#type-handshake_state.session" class="anchor"></a><code><span>session : <span><span>[ <span>`TLS of <a href="#type-session_data">session_data</a></span> <span><span>| `TLS13</span> of <a href="#type-session_data13">session_data13</a></span> ]</span> list</span>;</span></code></li><li id="type-handshake_state.protocol_version" class="def record field anchored"><a href="#type-handshake_state.protocol_version" class="anchor"></a><code><span>protocol_version : <a href="../Core/index.html#type-tls_version">Core.tls_version</a>;</span></code></li><li id="type-handshake_state.early_data_left" class="def record field anchored"><a href="#type-handshake_state.early_data_left" class="anchor"></a><code><span>early_data_left : int32;</span></code></li><li id="type-handshake_state.machina" class="def record field anchored"><a href="#type-handshake_state.machina" class="anchor"></a><code><span>machina : <a href="#type-handshake_machina_state">handshake_machina_state</a>;</span></code></li><li id="type-handshake_state.config" class="def record field anchored"><a href="#type-handshake_state.config" class="anchor"></a><code><span>config : <a href="../Config/index.html#type-config">Config.config</a>;</span></code></li><li id="type-handshake_state.hs_fragment" class="def record field anchored"><a href="#type-handshake_state.hs_fragment" class="anchor"></a><code><span>hs_fragment : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-crypto_state"><a href="#type-crypto_state" class="anchor"></a><code><span><span class="keyword">type</span> crypto_state</span><span> = <span><a href="#type-crypto_context">crypto_context</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-record"><a href="#type-record" class="anchor"></a><code><span><span class="keyword">type</span> record</span><span> = <a href="../Packet/index.html#type-content_type">Packet.content_type</a> * <span class="xref-unresolved">Cstruct</span>.t</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-rec_resp"><a href="#type-rec_resp" class="anchor"></a><code><span><span class="keyword">type</span> rec_resp</span><span> = </span><span>[ </span></code><ol><li id="type-rec_resp.Change_enc" class="def variant constructor anchored"><a href="#type-rec_resp.Change_enc" class="anchor"></a><code><span>| </span><span>`Change_enc <span class="keyword">of</span> <a href="#type-crypto_context">crypto_context</a></span></code></li><li id="type-rec_resp.Change_dec" class="def variant constructor anchored"><a href="#type-rec_resp.Change_dec" class="anchor"></a><code><span>| </span><span>`Change_dec <span class="keyword">of</span> <a href="#type-crypto_context">crypto_context</a></span></code></li><li id="type-rec_resp.Record" class="def variant constructor anchored"><a href="#type-rec_resp.Record" class="anchor"></a><code><span>| </span><span>`Record <span class="keyword">of</span> <a href="#type-record">record</a></span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-handshake_return"><a href="#type-handshake_return" class="anchor"></a><code><span><span class="keyword">type</span> handshake_return</span><span> = <a href="#type-handshake_state">handshake_state</a> * <span><a href="#type-rec_resp">rec_resp</a> list</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-state"><a href="#type-state" class="anchor"></a><code><span><span class="keyword">type</span> state</span><span> = </span><span>{</span></code><ol><li id="type-state.handshake" class="def record field anchored"><a href="#type-state.handshake" class="anchor"></a><code><span>handshake : <a href="#type-handshake_state">handshake_state</a>;</span></code></li><li id="type-state.decryptor" class="def record field anchored"><a href="#type-state.decryptor" class="anchor"></a><code><span>decryptor : <a href="#type-crypto_state">crypto_state</a>;</span></code></li><li id="type-state.encryptor" class="def record field anchored"><a href="#type-state.encryptor" class="anchor"></a><code><span>encryptor : <a href="#type-crypto_state">crypto_state</a>;</span></code></li><li id="type-state.fragment" class="def record field anchored"><a href="#type-state.fragment" class="anchor"></a><code><span>fragment : <span class="xref-unresolved">Cstruct</span>.t;</span></code></li><li id="type-state.read_closed" class="def record field anchored"><a href="#type-state.read_closed" class="anchor"></a><code><span>read_closed : bool;</span></code></li><li id="type-state.write_closed" class="def record field anchored"><a href="#type-state.write_closed" class="anchor"></a><code><span>write_closed : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-error"><a href="#type-error" class="anchor"></a><code><span><span class="keyword">type</span> error</span><span> = </span><span>[ </span></code><ol><li id="type-error.AuthenticationFailure" class="def variant constructor anchored"><a href="#type-error.AuthenticationFailure" class="anchor"></a><code><span>| </span><span>`AuthenticationFailure <span class="keyword">of</span> <span class="xref-unresolved">X509</span>.Validation.validation_error</span></code></li><li id="type-error.NoConfiguredCiphersuite" class="def variant constructor anchored"><a href="#type-error.NoConfiguredCiphersuite" class="anchor"></a><code><span>| </span><span>`NoConfiguredCiphersuite <span class="keyword">of</span> <span><a href="../Ciphersuite/index.html#type-ciphersuite">Ciphersuite.ciphersuite</a> list</span></span></code></li><li id="type-error.NoConfiguredVersions" class="def variant constructor anchored"><a href="#type-error.NoConfiguredVersions" class="anchor"></a><code><span>| </span><span>`NoConfiguredVersions <span class="keyword">of</span> <span><a href="../Core/index.html#type-tls_version">Core.tls_version</a> list</span></span></code></li><li id="type-error.NoConfiguredSignatureAlgorithm" class="def variant constructor anchored"><a href="#type-error.NoConfiguredSignatureAlgorithm" class="anchor"></a><code><span>| </span><span>`NoConfiguredSignatureAlgorithm <span class="keyword">of</span> <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></span></code></li><li id="type-error.NoMatchingCertificateFound" class="def variant constructor anchored"><a href="#type-error.NoMatchingCertificateFound" class="anchor"></a><code><span>| </span><span>`NoMatchingCertificateFound <span class="keyword">of</span> string</span></code></li><li id="type-error.NoCertificateConfigured" class="def variant constructor anchored"><a href="#type-error.NoCertificateConfigured" class="anchor"></a><code><span>| </span><span>`NoCertificateConfigured</span></code></li><li id="type-error.CouldntSelectCertificate" class="def variant constructor anchored"><a href="#type-error.CouldntSelectCertificate" class="anchor"></a><code><span>| </span><span>`CouldntSelectCertificate</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><code><span><span class="keyword">val</span> pp_error : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&lt; <span>`AuthenticationFailure of <span class="xref-unresolved">X509</span>.Validation.validation_error</span>
  <span>| `CouldntSelectCertificate</span>
  <span>| `NoCertificateConfigured</span>
  <span><span>| `NoConfiguredCiphersuite</span> of
    <span><span>[&lt; `AES_128_CCM_SHA256
    <span>| `AES_128_GCM_SHA256</span>
    <span>| `AES_256_GCM_SHA384</span>
    <span>| `CHACHA20_POLY1305_SHA256</span>
    <span>| `DHE_RSA_WITH_3DES_EDE_CBC_SHA</span>
    <span>| `DHE_RSA_WITH_AES_128_CBC_SHA</span>
    <span>| `DHE_RSA_WITH_AES_128_CBC_SHA256</span>
    <span>| `DHE_RSA_WITH_AES_128_CCM</span>
    <span>| `DHE_RSA_WITH_AES_128_GCM_SHA256</span>
    <span>| `DHE_RSA_WITH_AES_256_CBC_SHA</span>
    <span>| `DHE_RSA_WITH_AES_256_CBC_SHA256</span>
    <span>| `DHE_RSA_WITH_AES_256_CCM</span>
    <span>| `DHE_RSA_WITH_AES_256_GCM_SHA384</span>
    <span>| `DHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span>
    <span>| `ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA</span>
    <span>| `ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>
    <span>| `ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</span>
    <span>| `ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>
    <span>| `ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>
    <span>| `ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</span>
    <span>| `ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span>
    <span>| `ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span>
    <span>| `ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>
    <span>| `ECDHE_RSA_WITH_AES_128_CBC_SHA</span>
    <span>| `ECDHE_RSA_WITH_AES_128_CBC_SHA256</span>
    <span>| `ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>
    <span>| `ECDHE_RSA_WITH_AES_256_CBC_SHA</span>
    <span>| `ECDHE_RSA_WITH_AES_256_CBC_SHA384</span>
    <span>| `ECDHE_RSA_WITH_AES_256_GCM_SHA384</span>
    <span>| `ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span>
    <span>| `RSA_WITH_3DES_EDE_CBC_SHA</span>
    <span>| `RSA_WITH_AES_128_CBC_SHA</span>
    <span>| `RSA_WITH_AES_128_CBC_SHA256</span>
    <span>| `RSA_WITH_AES_128_CCM</span>
    <span>| `RSA_WITH_AES_128_GCM_SHA256</span>
    <span>| `RSA_WITH_AES_256_CBC_SHA</span>
    <span>| `RSA_WITH_AES_256_CBC_SHA256</span>
    <span>| `RSA_WITH_AES_256_CCM</span>
    <span>| `RSA_WITH_AES_256_GCM_SHA384</span> AES_128_CCM_SHA256 AES_128_GCM_SHA256 AES_256_GCM_SHA384 CHACHA20_POLY1305_SHA256 ]</span>
      list</span></span>
  <span><span>| `NoConfiguredSignatureAlgorithm</span> of
    <span><span>[&lt; `ECDSA_SECP256R1_SHA1
    <span>| `ECDSA_SECP256R1_SHA256</span>
    <span>| `ECDSA_SECP384R1_SHA384</span>
    <span>| `ECDSA_SECP521R1_SHA512</span>
    <span>| `ED25519</span>
    <span>| `RSA_PKCS1_MD5</span>
    <span>| `RSA_PKCS1_SHA1</span>
    <span>| `RSA_PKCS1_SHA224</span>
    <span>| `RSA_PKCS1_SHA256</span>
    <span>| `RSA_PKCS1_SHA384</span>
    <span>| `RSA_PKCS1_SHA512</span>
    <span>| `RSA_PSS_RSAENC_SHA256</span>
    <span>| `RSA_PSS_RSAENC_SHA384</span>
    <span>| `RSA_PSS_RSAENC_SHA512</span> ECDSA_SECP256R1_SHA1 ECDSA_SECP256R1_SHA256 ECDSA_SECP384R1_SHA384 ECDSA_SECP521R1_SHA512 ]</span>
      list</span></span>
  <span><span>| `NoConfiguredVersions</span> of
    <span><span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span> list</span></span>
  <span><span>| `NoMatchingCertificateFound</span> of string</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-client_hello_errors"><a href="#type-client_hello_errors" class="anchor"></a><code><span><span class="keyword">type</span> client_hello_errors</span><span> = </span><span>[ </span></code><ol><li id="type-client_hello_errors.EmptyCiphersuites" class="def variant constructor anchored"><a href="#type-client_hello_errors.EmptyCiphersuites" class="anchor"></a><code><span>| </span><span>`EmptyCiphersuites</span></code></li><li id="type-client_hello_errors.NotSetCiphersuites" class="def variant constructor anchored"><a href="#type-client_hello_errors.NotSetCiphersuites" class="anchor"></a><code><span>| </span><span>`NotSetCiphersuites <span class="keyword">of</span> <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span></code></li><li id="type-client_hello_errors.NoSupportedCiphersuite" class="def variant constructor anchored"><a href="#type-client_hello_errors.NoSupportedCiphersuite" class="anchor"></a><code><span>| </span><span>`NoSupportedCiphersuite <span class="keyword">of</span> <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span></code></li><li id="type-client_hello_errors.NotSetExtension" class="def variant constructor anchored"><a href="#type-client_hello_errors.NotSetExtension" class="anchor"></a><code><span>| </span><span>`NotSetExtension <span class="keyword">of</span> <span><a href="../Core/index.html#type-client_extension">Core.client_extension</a> list</span></span></code></li><li id="type-client_hello_errors.NoSignatureAlgorithmsExtension" class="def variant constructor anchored"><a href="#type-client_hello_errors.NoSignatureAlgorithmsExtension" class="anchor"></a><code><span>| </span><span>`NoSignatureAlgorithmsExtension</span></code></li><li id="type-client_hello_errors.NoGoodSignatureAlgorithms" class="def variant constructor anchored"><a href="#type-client_hello_errors.NoGoodSignatureAlgorithms" class="anchor"></a><code><span>| </span><span>`NoGoodSignatureAlgorithms <span class="keyword">of</span> <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></span></code></li><li id="type-client_hello_errors.NoKeyShareExtension" class="def variant constructor anchored"><a href="#type-client_hello_errors.NoKeyShareExtension" class="anchor"></a><code><span>| </span><span>`NoKeyShareExtension</span></code></li><li id="type-client_hello_errors.NoSupportedGroupExtension" class="def variant constructor anchored"><a href="#type-client_hello_errors.NoSupportedGroupExtension" class="anchor"></a><code><span>| </span><span>`NoSupportedGroupExtension</span></code></li><li id="type-client_hello_errors.NotSetSupportedGroup" class="def variant constructor anchored"><a href="#type-client_hello_errors.NotSetSupportedGroup" class="anchor"></a><code><span>| </span><span>`NotSetSupportedGroup <span class="keyword">of</span> <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span></span></code></li><li id="type-client_hello_errors.NotSetKeyShare" class="def variant constructor anchored"><a href="#type-client_hello_errors.NotSetKeyShare" class="anchor"></a><code><span>| </span><span>`NotSetKeyShare <span class="keyword">of</span> <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="xref-unresolved">Cstruct</span>.t)</span> list</span></span></code></li><li id="type-client_hello_errors.NotSubsetKeyShareSupportedGroup" class="def variant constructor anchored"><a href="#type-client_hello_errors.NotSubsetKeyShareSupportedGroup" class="anchor"></a><code><span>| </span><span>`NotSubsetKeyShareSupportedGroup <span class="keyword">of</span>
  <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span> * <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="xref-unresolved">Cstruct</span>.t)</span> list</span></span></code></li><li id="type-client_hello_errors.Has0rttAfterHRR" class="def variant constructor anchored"><a href="#type-client_hello_errors.Has0rttAfterHRR" class="anchor"></a><code><span>| </span><span>`Has0rttAfterHRR</span></code></li><li id="type-client_hello_errors.NoCookie" class="def variant constructor anchored"><a href="#type-client_hello_errors.NoCookie" class="anchor"></a><code><span>| </span><span>`NoCookie</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_client_hello_error"><a href="#val-pp_client_hello_error" class="anchor"></a><code><span><span class="keyword">val</span> pp_client_hello_error : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&lt; `EmptyCiphersuites
  <span>| `Has0rttAfterHRR</span>
  <span>| `NoCookie</span>
  <span><span>| `NoGoodSignatureAlgorithms</span> of
    <span><span>[&lt; `ECDSA_SECP256R1_SHA1
    <span>| `ECDSA_SECP256R1_SHA256</span>
    <span>| `ECDSA_SECP384R1_SHA384</span>
    <span>| `ECDSA_SECP521R1_SHA512</span>
    <span>| `ED25519</span>
    <span>| `RSA_PKCS1_MD5</span>
    <span>| `RSA_PKCS1_SHA1</span>
    <span>| `RSA_PKCS1_SHA224</span>
    <span>| `RSA_PKCS1_SHA256</span>
    <span>| `RSA_PKCS1_SHA384</span>
    <span>| `RSA_PKCS1_SHA512</span>
    <span>| `RSA_PSS_RSAENC_SHA256</span>
    <span>| `RSA_PSS_RSAENC_SHA384</span>
    <span>| `RSA_PSS_RSAENC_SHA512</span> ECDSA_SECP256R1_SHA1 ECDSA_SECP256R1_SHA256 ECDSA_SECP384R1_SHA384 ECDSA_SECP521R1_SHA512 ]</span>
      list</span></span>
  <span>| `NoKeyShareExtension</span>
  <span>| `NoSignatureAlgorithmsExtension</span>
  <span><span>| `NoSupportedCiphersuite</span> of <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span>
  <span>| `NoSupportedGroupExtension</span>
  <span><span>| `NotSetCiphersuites</span> of <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span>
  <span><span>| `NotSetExtension</span> of <span class="type-var">'a</span></span>
  <span><span>| `NotSetKeyShare</span> of <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="type-var">'b</span>)</span> list</span></span>
  <span><span>| `NotSetSupportedGroup</span> of <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span></span>
  <span><span>| `NotSubsetKeyShareSupportedGroup</span> of
    <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span> * <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="type-var">'c</span>)</span> list</span></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-fatal"><a href="#type-fatal" class="anchor"></a><code><span><span class="keyword">type</span> fatal</span><span> = </span><span>[ </span></code><ol><li id="type-fatal.NoSecureRenegotiation" class="def variant constructor anchored"><a href="#type-fatal.NoSecureRenegotiation" class="anchor"></a><code><span>| </span><span>`NoSecureRenegotiation</span></code></li><li id="type-fatal.NoSupportedGroup" class="def variant constructor anchored"><a href="#type-fatal.NoSupportedGroup" class="anchor"></a><code><span>| </span><span>`NoSupportedGroup</span></code></li><li id="type-fatal.NoVersions" class="def variant constructor anchored"><a href="#type-fatal.NoVersions" class="anchor"></a><code><span>| </span><span>`NoVersions <span class="keyword">of</span> <span><a href="../Core/index.html#type-tls_any_version">Core.tls_any_version</a> list</span></span></code></li><li id="type-fatal.ReaderError" class="def variant constructor anchored"><a href="#type-fatal.ReaderError" class="anchor"></a><code><span>| </span><span>`ReaderError <span class="keyword">of</span> <a href="../Reader/index.html#type-error">Reader.error</a></span></code></li><li id="type-fatal.NoCertificateReceived" class="def variant constructor anchored"><a href="#type-fatal.NoCertificateReceived" class="anchor"></a><code><span>| </span><span>`NoCertificateReceived</span></code></li><li id="type-fatal.NoCertificateVerifyReceived" class="def variant constructor anchored"><a href="#type-fatal.NoCertificateVerifyReceived" class="anchor"></a><code><span>| </span><span>`NoCertificateVerifyReceived</span></code></li><li id="type-fatal.NotRSACertificate" class="def variant constructor anchored"><a href="#type-fatal.NotRSACertificate" class="anchor"></a><code><span>| </span><span>`NotRSACertificate</span></code></li><li id="type-fatal.KeyTooSmall" class="def variant constructor anchored"><a href="#type-fatal.KeyTooSmall" class="anchor"></a><code><span>| </span><span>`KeyTooSmall</span></code></li><li id="type-fatal.SignatureVerificationFailed" class="def variant constructor anchored"><a href="#type-fatal.SignatureVerificationFailed" class="anchor"></a><code><span>| </span><span>`SignatureVerificationFailed <span class="keyword">of</span> string</span></code></li><li id="type-fatal.SigningFailed" class="def variant constructor anchored"><a href="#type-fatal.SigningFailed" class="anchor"></a><code><span>| </span><span>`SigningFailed <span class="keyword">of</span> string</span></code></li><li id="type-fatal.BadCertificateChain" class="def variant constructor anchored"><a href="#type-fatal.BadCertificateChain" class="anchor"></a><code><span>| </span><span>`BadCertificateChain</span></code></li><li id="type-fatal.MACMismatch" class="def variant constructor anchored"><a href="#type-fatal.MACMismatch" class="anchor"></a><code><span>| </span><span>`MACMismatch</span></code></li><li id="type-fatal.MACUnderflow" class="def variant constructor anchored"><a href="#type-fatal.MACUnderflow" class="anchor"></a><code><span>| </span><span>`MACUnderflow</span></code></li><li id="type-fatal.RecordOverflow" class="def variant constructor anchored"><a href="#type-fatal.RecordOverflow" class="anchor"></a><code><span>| </span><span>`RecordOverflow <span class="keyword">of</span> int</span></code></li><li id="type-fatal.UnknownRecordVersion" class="def variant constructor anchored"><a href="#type-fatal.UnknownRecordVersion" class="anchor"></a><code><span>| </span><span>`UnknownRecordVersion <span class="keyword">of</span> int * int</span></code></li><li id="type-fatal.UnknownContentType" class="def variant constructor anchored"><a href="#type-fatal.UnknownContentType" class="anchor"></a><code><span>| </span><span>`UnknownContentType <span class="keyword">of</span> int</span></code></li><li id="type-fatal.CannotHandleApplicationDataYet" class="def variant constructor anchored"><a href="#type-fatal.CannotHandleApplicationDataYet" class="anchor"></a><code><span>| </span><span>`CannotHandleApplicationDataYet</span></code></li><li id="type-fatal.NoHeartbeat" class="def variant constructor anchored"><a href="#type-fatal.NoHeartbeat" class="anchor"></a><code><span>| </span><span>`NoHeartbeat</span></code></li><li id="type-fatal.BadRecordVersion" class="def variant constructor anchored"><a href="#type-fatal.BadRecordVersion" class="anchor"></a><code><span>| </span><span>`BadRecordVersion <span class="keyword">of</span> <a href="../Core/index.html#type-tls_any_version">Core.tls_any_version</a></span></code></li><li id="type-fatal.BadFinished" class="def variant constructor anchored"><a href="#type-fatal.BadFinished" class="anchor"></a><code><span>| </span><span>`BadFinished</span></code></li><li id="type-fatal.HandshakeFragmentsNotEmpty" class="def variant constructor anchored"><a href="#type-fatal.HandshakeFragmentsNotEmpty" class="anchor"></a><code><span>| </span><span>`HandshakeFragmentsNotEmpty</span></code></li><li id="type-fatal.InsufficientDH" class="def variant constructor anchored"><a href="#type-fatal.InsufficientDH" class="anchor"></a><code><span>| </span><span>`InsufficientDH</span></code></li><li id="type-fatal.InvalidDH" class="def variant constructor anchored"><a href="#type-fatal.InvalidDH" class="anchor"></a><code><span>| </span><span>`InvalidDH</span></code></li><li id="type-fatal.BadECDH" class="def variant constructor anchored"><a href="#type-fatal.BadECDH" class="anchor"></a><code><span>| </span><span>`BadECDH <span class="keyword">of</span> <span class="xref-unresolved">Mirage_crypto_ec</span>.error</span></code></li><li id="type-fatal.InvalidRenegotiation" class="def variant constructor anchored"><a href="#type-fatal.InvalidRenegotiation" class="anchor"></a><code><span>| </span><span>`InvalidRenegotiation</span></code></li><li id="type-fatal.InvalidClientHello" class="def variant constructor anchored"><a href="#type-fatal.InvalidClientHello" class="anchor"></a><code><span>| </span><span>`InvalidClientHello <span class="keyword">of</span> <a href="#type-client_hello_errors">client_hello_errors</a></span></code></li><li id="type-fatal.InvalidServerHello" class="def variant constructor anchored"><a href="#type-fatal.InvalidServerHello" class="anchor"></a><code><span>| </span><span>`InvalidServerHello</span></code></li><li id="type-fatal.InvalidRenegotiationVersion" class="def variant constructor anchored"><a href="#type-fatal.InvalidRenegotiationVersion" class="anchor"></a><code><span>| </span><span>`InvalidRenegotiationVersion <span class="keyword">of</span> <a href="../Core/index.html#type-tls_version">Core.tls_version</a></span></code></li><li id="type-fatal.InappropriateFallback" class="def variant constructor anchored"><a href="#type-fatal.InappropriateFallback" class="anchor"></a><code><span>| </span><span>`InappropriateFallback</span></code></li><li id="type-fatal.UnexpectedCCS" class="def variant constructor anchored"><a href="#type-fatal.UnexpectedCCS" class="anchor"></a><code><span>| </span><span>`UnexpectedCCS</span></code></li><li id="type-fatal.UnexpectedHandshake" class="def variant constructor anchored"><a href="#type-fatal.UnexpectedHandshake" class="anchor"></a><code><span>| </span><span>`UnexpectedHandshake <span class="keyword">of</span> <a href="../Core/index.html#type-tls_handshake">Core.tls_handshake</a></span></code></li><li id="type-fatal.InvalidCertificateUsage" class="def variant constructor anchored"><a href="#type-fatal.InvalidCertificateUsage" class="anchor"></a><code><span>| </span><span>`InvalidCertificateUsage</span></code></li><li id="type-fatal.InvalidCertificateExtendedUsage" class="def variant constructor anchored"><a href="#type-fatal.InvalidCertificateExtendedUsage" class="anchor"></a><code><span>| </span><span>`InvalidCertificateExtendedUsage</span></code></li><li id="type-fatal.InvalidSession" class="def variant constructor anchored"><a href="#type-fatal.InvalidSession" class="anchor"></a><code><span>| </span><span>`InvalidSession</span></code></li><li id="type-fatal.NoApplicationProtocol" class="def variant constructor anchored"><a href="#type-fatal.NoApplicationProtocol" class="anchor"></a><code><span>| </span><span>`NoApplicationProtocol</span></code></li><li id="type-fatal.HelloRetryRequest" class="def variant constructor anchored"><a href="#type-fatal.HelloRetryRequest" class="anchor"></a><code><span>| </span><span>`HelloRetryRequest</span></code></li><li id="type-fatal.InvalidMessage" class="def variant constructor anchored"><a href="#type-fatal.InvalidMessage" class="anchor"></a><code><span>| </span><span>`InvalidMessage</span></code></li><li id="type-fatal.Toomany0rttbytes" class="def variant constructor anchored"><a href="#type-fatal.Toomany0rttbytes" class="anchor"></a><code><span>| </span><span>`Toomany0rttbytes</span></code></li><li id="type-fatal.MissingContentType" class="def variant constructor anchored"><a href="#type-fatal.MissingContentType" class="anchor"></a><code><span>| </span><span>`MissingContentType</span></code></li><li id="type-fatal.Downgrade12" class="def variant constructor anchored"><a href="#type-fatal.Downgrade12" class="anchor"></a><code><span>| </span><span>`Downgrade12</span></code></li><li id="type-fatal.Downgrade11" class="def variant constructor anchored"><a href="#type-fatal.Downgrade11" class="anchor"></a><code><span>| </span><span>`Downgrade11</span></code></li><li id="type-fatal.WriteHalfClosed" class="def variant constructor anchored"><a href="#type-fatal.WriteHalfClosed" class="anchor"></a><code><span>| </span><span>`WriteHalfClosed</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_fatal"><a href="#val-pp_fatal" class="anchor"></a><code><span><span class="keyword">val</span> pp_fatal : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&lt; `BadCertificateChain
  <span><span>| `BadECDH</span> of <span class="xref-unresolved">Mirage_crypto_ec</span>.error</span>
  <span>| `BadFinished</span>
  <span><span>| `BadRecordVersion</span> of
    <span>[&lt; `SSL_3 <span>| `TLS_1_0</span> <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> <span><span>| `TLS_1_X</span> of int</span> ]</span></span>
  <span>| `CannotHandleApplicationDataYet</span>
  <span>| `Downgrade11</span>
  <span>| `Downgrade12</span>
  <span>| `HandshakeFragmentsNotEmpty</span>
  <span>| `HelloRetryRequest</span>
  <span>| `InappropriateFallback</span>
  <span>| `InsufficientDH</span>
  <span>| `InvalidCertificateExtendedUsage</span>
  <span>| `InvalidCertificateUsage</span>
  <span><span>| `InvalidClientHello</span> of
    <span>[&lt; `EmptyCiphersuites
    <span>| `Has0rttAfterHRR</span>
    <span>| `NoCookie</span>
    <span><span>| `NoGoodSignatureAlgorithms</span> of
      <span><span>[&lt; `ECDSA_SECP256R1_SHA1
      <span>| `ECDSA_SECP256R1_SHA256</span>
      <span>| `ECDSA_SECP384R1_SHA384</span>
      <span>| `ECDSA_SECP521R1_SHA512</span>
      <span>| `ED25519</span>
      <span>| `RSA_PKCS1_MD5</span>
      <span>| `RSA_PKCS1_SHA1</span>
      <span>| `RSA_PKCS1_SHA224</span>
      <span>| `RSA_PKCS1_SHA256</span>
      <span>| `RSA_PKCS1_SHA384</span>
      <span>| `RSA_PKCS1_SHA512</span>
      <span>| `RSA_PSS_RSAENC_SHA256</span>
      <span>| `RSA_PSS_RSAENC_SHA384</span>
      <span>| `RSA_PSS_RSAENC_SHA512</span> ECDSA_SECP256R1_SHA1 ECDSA_SECP256R1_SHA256 ECDSA_SECP384R1_SHA384 ECDSA_SECP521R1_SHA512 ]</span>
        list</span></span>
    <span>| `NoKeyShareExtension</span>
    <span>| `NoSignatureAlgorithmsExtension</span>
    <span><span>| `NoSupportedCiphersuite</span> of <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span>
    <span>| `NoSupportedGroupExtension</span>
    <span><span>| `NotSetCiphersuites</span> of <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span>
    <span><span>| `NotSetExtension</span> of <span class="type-var">'a</span></span>
    <span><span>| `NotSetKeyShare</span> of <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="type-var">'b</span>)</span> list</span></span>
    <span><span>| `NotSetSupportedGroup</span> of <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span></span>
    <span><span>| `NotSubsetKeyShareSupportedGroup</span> of
      <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span> * <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="type-var">'c</span>)</span> list</span></span> ]</span></span>
  <span>| `InvalidDH</span>
  <span>| `InvalidMessage</span>
  <span>| `InvalidRenegotiation</span>
  <span><span>| `InvalidRenegotiationVersion</span> of
    <span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span></span>
  <span>| `InvalidServerHello</span>
  <span>| `InvalidSession</span>
  <span>| `KeyTooSmall</span>
  <span>| `MACMismatch</span>
  <span>| `MACUnderflow</span>
  <span>| `MissingContentType</span>
  <span>| `NoApplicationProtocol</span>
  <span>| `NoCertificateReceived</span>
  <span>| `NoCertificateVerifyReceived</span>
  <span>| `NoHeartbeat</span>
  <span>| `NoSecureRenegotiation</span>
  <span>| `NoSupportedGroup</span>
  <span><span>| `NoVersions</span> of
    <span><span>[&lt; `SSL_3 <span>| `TLS_1_0</span> <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> <span><span>| `TLS_1_X</span> of int</span> ]</span>
      list</span></span>
  <span>| `NotRSACertificate</span>
  <span><span>| `ReaderError</span> of <a href="../Reader/index.html#type-error">Reader.error</a></span>
  <span><span>| `RecordOverflow</span> of int</span>
  <span><span>| `SignatureVerificationFailed</span> of string</span>
  <span><span>| `SigningFailed</span> of string</span>
  <span>| `Toomany0rttbytes</span>
  <span>| `UnexpectedCCS</span>
  <span><span>| `UnexpectedHandshake</span> of <a href="../Core/index.html#type-tls_handshake">Core.tls_handshake</a></span>
  <span><span>| `UnknownContentType</span> of int</span>
  <span><span>| `UnknownRecordVersion</span> of int * int</span>
  <span>| `WriteHalfClosed</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-failure"><a href="#type-failure" class="anchor"></a><code><span><span class="keyword">type</span> failure</span><span> = </span><span>[ </span></code><ol><li id="type-failure.Error" class="def variant constructor anchored"><a href="#type-failure.Error" class="anchor"></a><code><span>| </span><span>`Error <span class="keyword">of</span> <a href="#type-error">error</a></span></code></li><li id="type-failure.Fatal" class="def variant constructor anchored"><a href="#type-failure.Fatal" class="anchor"></a><code><span>| </span><span>`Fatal <span class="keyword">of</span> <a href="#type-fatal">fatal</a></span></code></li><li id="type-failure.Alert" class="def variant constructor anchored"><a href="#type-failure.Alert" class="anchor"></a><code><span>| </span><span>`Alert <span class="keyword">of</span> <a href="../Packet/index.html#type-alert_type">Packet.alert_type</a></span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_failure"><a href="#val-pp_failure" class="anchor"></a><code><span><span class="keyword">val</span> pp_failure : 
  <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&lt; <span>`Alert of <a href="../Packet/index.html#type-alert_type">Packet.alert_type</a></span>
  <span><span>| `Error</span> of
    <span>[&lt; <span>`AuthenticationFailure of <span class="xref-unresolved">X509</span>.Validation.validation_error</span>
    <span>| `CouldntSelectCertificate</span>
    <span>| `NoCertificateConfigured</span>
    <span><span>| `NoConfiguredCiphersuite</span> of
      <span><span>[&lt; `AES_128_CCM_SHA256
      <span>| `AES_128_GCM_SHA256</span>
      <span>| `AES_256_GCM_SHA384</span>
      <span>| `CHACHA20_POLY1305_SHA256</span>
      <span>| `DHE_RSA_WITH_3DES_EDE_CBC_SHA</span>
      <span>| `DHE_RSA_WITH_AES_128_CBC_SHA</span>
      <span>| `DHE_RSA_WITH_AES_128_CBC_SHA256</span>
      <span>| `DHE_RSA_WITH_AES_128_CCM</span>
      <span>| `DHE_RSA_WITH_AES_128_GCM_SHA256</span>
      <span>| `DHE_RSA_WITH_AES_256_CBC_SHA</span>
      <span>| `DHE_RSA_WITH_AES_256_CBC_SHA256</span>
      <span>| `DHE_RSA_WITH_AES_256_CCM</span>
      <span>| `DHE_RSA_WITH_AES_256_GCM_SHA384</span>
      <span>| `DHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span>
      <span>| `ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA</span>
      <span>| `ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>
      <span>| `ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</span>
      <span>| `ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span>
      <span>| `ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>
      <span>| `ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</span>
      <span>| `ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span>
      <span>| `ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span>
      <span>| `ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</span>
      <span>| `ECDHE_RSA_WITH_AES_128_CBC_SHA</span>
      <span>| `ECDHE_RSA_WITH_AES_128_CBC_SHA256</span>
      <span>| `ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>
      <span>| `ECDHE_RSA_WITH_AES_256_CBC_SHA</span>
      <span>| `ECDHE_RSA_WITH_AES_256_CBC_SHA384</span>
      <span>| `ECDHE_RSA_WITH_AES_256_GCM_SHA384</span>
      <span>| `ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span>
      <span>| `RSA_WITH_3DES_EDE_CBC_SHA</span>
      <span>| `RSA_WITH_AES_128_CBC_SHA</span>
      <span>| `RSA_WITH_AES_128_CBC_SHA256</span>
      <span>| `RSA_WITH_AES_128_CCM</span>
      <span>| `RSA_WITH_AES_128_GCM_SHA256</span>
      <span>| `RSA_WITH_AES_256_CBC_SHA</span>
      <span>| `RSA_WITH_AES_256_CBC_SHA256</span>
      <span>| `RSA_WITH_AES_256_CCM</span>
      <span>| `RSA_WITH_AES_256_GCM_SHA384</span> AES_128_CCM_SHA256 AES_128_GCM_SHA256 AES_256_GCM_SHA384 CHACHA20_POLY1305_SHA256 ]</span>
        list</span></span>
    <span><span>| `NoConfiguredSignatureAlgorithm</span> of
      <span><span>[&lt; `ECDSA_SECP256R1_SHA1
      <span>| `ECDSA_SECP256R1_SHA256</span>
      <span>| `ECDSA_SECP384R1_SHA384</span>
      <span>| `ECDSA_SECP521R1_SHA512</span>
      <span>| `ED25519</span>
      <span>| `RSA_PKCS1_MD5</span>
      <span>| `RSA_PKCS1_SHA1</span>
      <span>| `RSA_PKCS1_SHA224</span>
      <span>| `RSA_PKCS1_SHA256</span>
      <span>| `RSA_PKCS1_SHA384</span>
      <span>| `RSA_PKCS1_SHA512</span>
      <span>| `RSA_PSS_RSAENC_SHA256</span>
      <span>| `RSA_PSS_RSAENC_SHA384</span>
      <span>| `RSA_PSS_RSAENC_SHA512</span> ECDSA_SECP256R1_SHA1 ECDSA_SECP256R1_SHA256 ECDSA_SECP384R1_SHA384 ECDSA_SECP521R1_SHA512 ]</span>
        list</span></span>
    <span><span>| `NoConfiguredVersions</span> of
      <span><span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span> list</span></span>
    <span><span>| `NoMatchingCertificateFound</span> of string</span> ]</span></span>
  <span><span>| `Fatal</span> of
    <span>[&lt; `BadCertificateChain
    <span><span>| `BadECDH</span> of <span class="xref-unresolved">Mirage_crypto_ec</span>.error</span>
    <span>| `BadFinished</span>
    <span><span>| `BadRecordVersion</span> of
      <span>[&lt; `SSL_3 <span>| `TLS_1_0</span> <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> <span><span>| `TLS_1_X</span> of int</span> ]</span></span>
    <span>| `CannotHandleApplicationDataYet</span>
    <span>| `Downgrade11</span>
    <span>| `Downgrade12</span>
    <span>| `HandshakeFragmentsNotEmpty</span>
    <span>| `HelloRetryRequest</span>
    <span>| `InappropriateFallback</span>
    <span>| `InsufficientDH</span>
    <span>| `InvalidCertificateExtendedUsage</span>
    <span>| `InvalidCertificateUsage</span>
    <span><span>| `InvalidClientHello</span> of
      <span>[&lt; `EmptyCiphersuites
      <span>| `Has0rttAfterHRR</span>
      <span>| `NoCookie</span>
      <span><span>| `NoGoodSignatureAlgorithms</span> of
        <span><span>[&lt; `ECDSA_SECP256R1_SHA1
        <span>| `ECDSA_SECP256R1_SHA256</span>
        <span>| `ECDSA_SECP384R1_SHA384</span>
        <span>| `ECDSA_SECP521R1_SHA512</span>
        <span>| `ED25519</span>
        <span>| `RSA_PKCS1_MD5</span>
        <span>| `RSA_PKCS1_SHA1</span>
        <span>| `RSA_PKCS1_SHA224</span>
        <span>| `RSA_PKCS1_SHA256</span>
        <span>| `RSA_PKCS1_SHA384</span>
        <span>| `RSA_PKCS1_SHA512</span>
        <span>| `RSA_PSS_RSAENC_SHA256</span>
        <span>| `RSA_PSS_RSAENC_SHA384</span>
        <span>| `RSA_PSS_RSAENC_SHA512</span> ECDSA_SECP256R1_SHA1 ECDSA_SECP256R1_SHA256 ECDSA_SECP384R1_SHA384 ECDSA_SECP521R1_SHA512 ]</span>
          list</span></span>
      <span>| `NoKeyShareExtension</span>
      <span>| `NoSignatureAlgorithmsExtension</span>
      <span><span>| `NoSupportedCiphersuite</span> of <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span>
      <span>| `NoSupportedGroupExtension</span>
      <span><span>| `NotSetCiphersuites</span> of <span><a href="../Packet/index.html#type-any_ciphersuite">Packet.any_ciphersuite</a> list</span></span>
      <span><span>| `NotSetExtension</span> of <span class="type-var">'a</span></span>
      <span><span>| `NotSetKeyShare</span> of <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="type-var">'b</span>)</span> list</span></span>
      <span><span>| `NotSetSupportedGroup</span> of <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span></span>
      <span><span>| `NotSubsetKeyShareSupportedGroup</span> of
        <span><a href="../Packet/index.html#type-named_group">Packet.named_group</a> list</span> * <span><span>(<a href="../Packet/index.html#type-named_group">Packet.named_group</a> * <span class="type-var">'c</span>)</span> list</span></span> ]</span></span>
    <span>| `InvalidDH</span>
    <span>| `InvalidMessage</span>
    <span>| `InvalidRenegotiation</span>
    <span><span>| `InvalidRenegotiationVersion</span> of
      <span>[&lt; `TLS_1_0 <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> ]</span></span>
    <span>| `InvalidServerHello</span>
    <span>| `InvalidSession</span>
    <span>| `KeyTooSmall</span>
    <span>| `MACMismatch</span>
    <span>| `MACUnderflow</span>
    <span>| `MissingContentType</span>
    <span>| `NoApplicationProtocol</span>
    <span>| `NoCertificateReceived</span>
    <span>| `NoCertificateVerifyReceived</span>
    <span>| `NoHeartbeat</span>
    <span>| `NoSecureRenegotiation</span>
    <span>| `NoSupportedGroup</span>
    <span><span>| `NoVersions</span> of
      <span><span>[&lt; `SSL_3 <span>| `TLS_1_0</span> <span>| `TLS_1_1</span> <span>| `TLS_1_2</span> <span>| `TLS_1_3</span> <span><span>| `TLS_1_X</span> of int</span> ]</span>
        list</span></span>
    <span>| `NotRSACertificate</span>
    <span><span>| `ReaderError</span> of <a href="../Reader/index.html#type-error">Reader.error</a></span>
    <span><span>| `RecordOverflow</span> of int</span>
    <span><span>| `SignatureVerificationFailed</span> of string</span>
    <span><span>| `SigningFailed</span> of string</span>
    <span>| `Toomany0rttbytes</span>
    <span>| `UnexpectedCCS</span>
    <span><span>| `UnexpectedHandshake</span> of <a href="../Core/index.html#type-tls_handshake">Core.tls_handshake</a></span>
    <span><span>| `UnknownContentType</span> of int</span>
    <span><span>| `UnknownRecordVersion</span> of int * int</span>
    <span>| `WriteHalfClosed</span> ]</span></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-common_data_to_epoch"><a href="#val-common_data_to_epoch" class="anchor"></a><code><span><span class="keyword">val</span> common_data_to_epoch : 
  <span><a href="#type-common_session_data">common_session_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span>bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>[ `host ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Core/index.html#type-epoch_data">Core.epoch_data</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-epoch_of_session"><a href="#val-epoch_of_session" class="anchor"></a><code><span><span class="keyword">val</span> epoch_of_session : 
  <span>bool <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><span>[ `host ]</span> <span class="xref-unresolved">Domain_name</span>.t</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Core/index.html#type-tls_version">Core.tls_version</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&lt; <span>`TLS of <a href="#type-session_data">session_data</a></span> <span><span>| `TLS13</span> of <a href="#type-session_data13">session_data13</a></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Core/index.html#type-epoch_data">Core.epoch_data</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-epoch_of_hs"><a href="#val-epoch_of_hs" class="anchor"></a><code><span><span class="keyword">val</span> epoch_of_hs : <span><a href="#type-handshake_state">handshake_state</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Core/index.html#type-epoch_data">Core.epoch_data</a> option</span></span></code></div></div></div></body></html>
