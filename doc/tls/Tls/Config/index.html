<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Config (tls.Tls.Config)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">tls</a> &#x00BB; <a href="../index.html">Tls</a> &#x00BB; Config</nav><h1>Module <code>Tls.Config</code></h1><nav class="toc"><ul><li><a href="#config-type">Config type</a></li><li><a href="#constructors">Constructors</a></li><li><a href="#note-on-alpn-protocol-selection">Note on ALPN protocol selection</a></li><li><a href="#utility-functions">Utility functions</a></li><li><a href="#internal-use-only">Internal use only</a></li></ul></nav></header><aside><p>Configuration of the TLS stack</p></aside><section><header><h2 id="config-type"><a href="#config-type" class="anchor"></a>Config type</h2></header><dl><dt class="spec type" id="type-certchain"><a href="#type-certchain" class="anchor"></a><code><span class="keyword">type</span> certchain</code><code> = <span><a href="../../Tls__Core/index.html#module-Cert">Tls.Core.Cert</a>.t list</span> * Mirage_crypto_pk.Rsa.priv</code></dt><dd><p>certificate chain and private key of the first certificate</p></dd></dl><dl><dt class="spec type" id="type-own_cert"><a href="#type-own_cert" class="anchor"></a><code><span class="keyword">type</span> own_cert</code> = <code>[ </code><table class="variant"><tr id="type-own_cert.None" class="anchored"><td class="def constructor"><a href="#type-own_cert.None" class="anchor"></a><code>| </code><code>`None</code></td></tr><tr id="type-own_cert.Single" class="anchored"><td class="def constructor"><a href="#type-own_cert.Single" class="anchor"></a><code>| </code><code>`Single <span class="keyword">of</span> <a href="index.html#type-certchain">certchain</a></code></td></tr><tr id="type-own_cert.Multiple" class="anchored"><td class="def constructor"><a href="#type-own_cert.Multiple" class="anchor"></a><code>| </code><code>`Multiple <span class="keyword">of</span> <span><a href="index.html#type-certchain">certchain</a> list</span></code></td></tr><tr id="type-own_cert.Multiple_default" class="anchored"><td class="def constructor"><a href="#type-own_cert.Multiple_default" class="anchor"></a><code>| </code><code>`Multiple_default <span class="keyword">of</span> <a href="index.html#type-certchain">certchain</a> * <span><a href="index.html#type-certchain">certchain</a> list</span></code></td></tr></table><code> ]</code></dt><dd><p>polymorphic variant of own certificates</p></dd></dl><dl><dt class="spec type" id="type-session_cache"><a href="#type-session_cache" class="anchor"></a><code><span class="keyword">type</span> session_cache</code><code> = <a href="../Core/SessionID/index.html#type-t">Core.SessionID.t</a> <span>&#45;&gt;</span> <span><a href="../Core/index.html#type-epoch_data">Core.epoch_data</a> option</span></code></dt><dt class="spec type" id="type-ticket_cache"><a href="#type-ticket_cache" class="anchor"></a><code><span class="keyword">type</span> ticket_cache</code><code> = </code><code>{</code><table class="record"><tr id="type-ticket_cache.lookup" class="anchored"><td class="def field"><a href="#type-ticket_cache.lookup" class="anchor"></a><code>lookup : Cstruct.t <span>&#45;&gt;</span> <span><span>(<a href="../Core/index.html#type-psk13">Core.psk13</a> * <a href="../Core/index.html#type-epoch_data">Core.epoch_data</a>)</span> option</span>;</code></td></tr><tr id="type-ticket_cache.ticket_granted" class="anchored"><td class="def field"><a href="#type-ticket_cache.ticket_granted" class="anchor"></a><code>ticket_granted : <a href="../Core/index.html#type-psk13">Core.psk13</a> <span>&#45;&gt;</span> <a href="../Core/index.html#type-epoch_data">Core.epoch_data</a> <span>&#45;&gt;</span> unit;</code></td></tr><tr id="type-ticket_cache.lifetime" class="anchored"><td class="def field"><a href="#type-ticket_cache.lifetime" class="anchor"></a><code>lifetime : int32;</code></td></tr><tr id="type-ticket_cache.timestamp" class="anchored"><td class="def field"><a href="#type-ticket_cache.timestamp" class="anchor"></a><code>timestamp : unit <span>&#45;&gt;</span> <a href="../../Tls__Core/index.html#module-Ptime">Tls.Core.Ptime</a>.t;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-ticket_cache_opt"><a href="#type-ticket_cache_opt" class="anchor"></a><code><span class="keyword">type</span> ticket_cache_opt</code><code> = <span><a href="index.html#type-ticket_cache">ticket_cache</a> option</span></code></dt><dt class="spec type" id="type-config"><a href="#type-config" class="anchor"></a><code><span class="keyword">type</span> config</code><code> = <span class="keyword">private</span> </code><code>{</code><table class="record"><tr id="type-config.ciphers" class="anchored"><td class="def field"><a href="#type-config.ciphers" class="anchor"></a><code>ciphers : <span><a href="../Ciphersuite/index.html#type-ciphersuite">Ciphersuite.ciphersuite</a> list</span>;</code></td><td class="doc"><p>ordered list (regarding preference) of supported cipher suites</p></td></tr><tr id="type-config.protocol_versions" class="anchored"><td class="def field"><a href="#type-config.protocol_versions" class="anchor"></a><code>protocol_versions : <a href="../Core/index.html#type-tls_version">Core.tls_version</a> * <a href="../Core/index.html#type-tls_version">Core.tls_version</a>;</code></td><td class="doc"><p>supported protocol versions (min, max)</p></td></tr><tr id="type-config.signature_algorithms" class="anchored"><td class="def field"><a href="#type-config.signature_algorithms" class="anchor"></a><code>signature_algorithms : <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span>;</code></td><td class="doc"><p>ordered list of supported signature algorithms (regarding preference)</p></td></tr><tr id="type-config.use_reneg" class="anchored"><td class="def field"><a href="#type-config.use_reneg" class="anchor"></a><code>use_reneg : bool;</code></td><td class="doc"><p>endpoint should accept renegotiation requests</p></td></tr><tr id="type-config.authenticator" class="anchored"><td class="def field"><a href="#type-config.authenticator" class="anchor"></a><code>authenticator : <span>X509.Authenticator.t option</span>;</code></td><td class="doc"><p>optional X509 authenticator</p></td></tr><tr id="type-config.peer_name" class="anchored"><td class="def field"><a href="#type-config.peer_name" class="anchor"></a><code>peer_name : <span>string option</span>;</code></td><td class="doc"><p>optional name of other endpoint (used for SNI RFC4366)</p></td></tr><tr id="type-config.own_certificates" class="anchored"><td class="def field"><a href="#type-config.own_certificates" class="anchor"></a><code>own_certificates : <a href="index.html#type-own_cert">own_cert</a>;</code></td><td class="doc"><p>optional default certificate chain and other certificate chains</p></td></tr><tr id="type-config.acceptable_cas" class="anchored"><td class="def field"><a href="#type-config.acceptable_cas" class="anchor"></a><code>acceptable_cas : <span>X509.Distinguished_name.t list</span>;</code></td><td class="doc"><p>ordered list of acceptable certificate authorities</p></td></tr><tr id="type-config.session_cache" class="anchored"><td class="def field"><a href="#type-config.session_cache" class="anchor"></a><code>session_cache : <a href="index.html#type-session_cache">session_cache</a>;</code></td></tr><tr id="type-config.ticket_cache" class="anchored"><td class="def field"><a href="#type-config.ticket_cache" class="anchor"></a><code>ticket_cache : <a href="index.html#type-ticket_cache_opt">ticket_cache_opt</a>;</code></td></tr><tr id="type-config.cached_session" class="anchored"><td class="def field"><a href="#type-config.cached_session" class="anchor"></a><code>cached_session : <span><a href="../Core/index.html#type-epoch_data">Core.epoch_data</a> option</span>;</code></td></tr><tr id="type-config.cached_ticket" class="anchored"><td class="def field"><a href="#type-config.cached_ticket" class="anchor"></a><code>cached_ticket : <span><span>(<a href="../Core/index.html#type-psk13">Core.psk13</a> * <a href="../Core/index.html#type-epoch_data">Core.epoch_data</a>)</span> option</span>;</code></td></tr><tr id="type-config.alpn_protocols" class="anchored"><td class="def field"><a href="#type-config.alpn_protocols" class="anchor"></a><code>alpn_protocols : <span>string list</span>;</code></td><td class="doc"><p>optional ordered list of accepted alpn_protocols</p></td></tr><tr id="type-config.groups" class="anchored"><td class="def field"><a href="#type-config.groups" class="anchor"></a><code>groups : <span><a href="../Core/index.html#type-group">Core.group</a> list</span>;</code></td><td class="doc"><p>the first FFDHE will be used for TLS 1.2 and below if a DHE ciphersuite is used</p></td></tr><tr id="type-config.zero_rtt" class="anchored"><td class="def field"><a href="#type-config.zero_rtt" class="anchor"></a><code>zero_rtt : int32;</code></td></tr></table><code>}</code></dt><dd><p>configuration parameters</p></dd></dl><dl><dt class="spec value" id="val-config_of_sexp"><a href="#val-config_of_sexp" class="anchor"></a><code><span class="keyword">val</span> config_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dt class="spec value" id="val-sexp_of_config"><a href="#val-sexp_of_config" class="anchor"></a><code><span class="keyword">val</span> sexp_of_config : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dt class="spec value" id="val-ciphers13"><a href="#val-ciphers13" class="anchor"></a><code><span class="keyword">val</span> ciphers13 : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> <span><a href="../Ciphersuite/index.html#type-ciphersuite13">Ciphersuite.ciphersuite13</a> list</span></code></dt><dd><p><code>ciphers13 config</code> are the ciphersuites for TLS 1.3 in the configuration.</p></dd></dl><dl><dt class="spec type" id="type-client"><a href="#type-client" class="anchor"></a><code><span class="keyword">type</span> client</code></dt><dd><p>opaque type of a client configuration</p></dd></dl><dl><dt class="spec value" id="val-client_of_sexp"><a href="#val-client_of_sexp" class="anchor"></a><code><span class="keyword">val</span> client_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-client">client</a></code></dt><dt class="spec value" id="val-sexp_of_client"><a href="#val-sexp_of_client" class="anchor"></a><code><span class="keyword">val</span> sexp_of_client : <a href="index.html#type-client">client</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt></dl><dl><dt class="spec type" id="type-server"><a href="#type-server" class="anchor"></a><code><span class="keyword">type</span> server</code></dt><dd><p>opaque type of a server configuration</p></dd></dl><dl><dt class="spec value" id="val-server_of_sexp"><a href="#val-server_of_sexp" class="anchor"></a><code><span class="keyword">val</span> server_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-server">server</a></code></dt><dt class="spec value" id="val-sexp_of_server"><a href="#val-sexp_of_server" class="anchor"></a><code><span class="keyword">val</span> sexp_of_server : <a href="index.html#type-server">server</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt></dl></section><section><header><h2 id="constructors"><a href="#constructors" class="anchor"></a>Constructors</h2></header><dl><dt class="spec value" id="val-client"><a href="#val-client" class="anchor"></a><code><span class="keyword">val</span> client : <span>authenticator:X509.Authenticator.t</span> <span>&#45;&gt;</span> <span>?&#8288;peer_name:string</span> <span>&#45;&gt;</span> <span>?&#8288;ciphers:<span><a href="../Ciphersuite/index.html#type-ciphersuite">Ciphersuite.ciphersuite</a> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;version:<span>(<a href="../Core/index.html#type-tls_version">Core.tls_version</a> * <a href="../Core/index.html#type-tls_version">Core.tls_version</a>)</span></span> <span>&#45;&gt;</span> <span>?&#8288;signature_algorithms:<span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;reneg:bool</span> <span>&#45;&gt;</span> <span>?&#8288;certificates:<a href="index.html#type-own_cert">own_cert</a></span> <span>&#45;&gt;</span> <span>?&#8288;cached_session:<a href="../Core/index.html#type-epoch_data">Core.epoch_data</a></span> <span>&#45;&gt;</span> <span>?&#8288;cached_ticket:<span>(<a href="../Core/index.html#type-psk13">Core.psk13</a> * <a href="../Core/index.html#type-epoch_data">Core.epoch_data</a>)</span></span> <span>&#45;&gt;</span> <span>?&#8288;ticket_cache:<a href="index.html#type-ticket_cache">ticket_cache</a></span> <span>&#45;&gt;</span> <span>?&#8288;alpn_protocols:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;groups:<span><a href="../Core/index.html#type-group">Core.group</a> list</span></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-client">client</a></code></dt><dd><p><code>client authenticator ?peer_name ?ciphers ?version ?hashes ?reneg ?certificates ?alpn_protocols</code> is <code>client</code> configuration with the given parameters.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the configuration is invalid</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-server"><a href="#val-server" class="anchor"></a><code><span class="keyword">val</span> server : <span>?&#8288;ciphers:<span><a href="../Ciphersuite/index.html#type-ciphersuite">Ciphersuite.ciphersuite</a> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;version:<span>(<a href="../Core/index.html#type-tls_version">Core.tls_version</a> * <a href="../Core/index.html#type-tls_version">Core.tls_version</a>)</span></span> <span>&#45;&gt;</span> <span>?&#8288;signature_algorithms:<span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;reneg:bool</span> <span>&#45;&gt;</span> <span>?&#8288;certificates:<a href="index.html#type-own_cert">own_cert</a></span> <span>&#45;&gt;</span> <span>?&#8288;acceptable_cas:<span>X509.Distinguished_name.t list</span></span> <span>&#45;&gt;</span> <span>?&#8288;authenticator:X509.Authenticator.t</span> <span>&#45;&gt;</span> <span>?&#8288;session_cache:<a href="index.html#type-session_cache">session_cache</a></span> <span>&#45;&gt;</span> <span>?&#8288;ticket_cache:<a href="index.html#type-ticket_cache">ticket_cache</a></span> <span>&#45;&gt;</span> <span>?&#8288;alpn_protocols:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;groups:<span><a href="../Core/index.html#type-group">Core.group</a> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;zero_rtt:int32</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-server">server</a></code></dt><dd><p><code>server ?ciphers ?version ?hashes ?reneg ?certificates ?acceptable_cas ?authenticator ?alpn_protocols</code> is <code>server</code> configuration with the given parameters.</p><dl><dt>raises Invalid_argument</dt><dd><p>if the configuration is invalid</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-peer"><a href="#val-peer" class="anchor"></a><code><span class="keyword">val</span> peer : <a href="index.html#type-client">client</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-client">client</a></code></dt><dd><p><code>peer client name</code> is <code>client</code> with <code>name</code> as <code>peer_name</code></p></dd></dl></section><section><header><h2 id="note-on-alpn-protocol-selection"><a href="#note-on-alpn-protocol-selection" class="anchor"></a>Note on ALPN protocol selection</h2><p>Both <a href="index.html#val-client"><code>client</code></a> and <a href="index.html#val-server"><code>server</code></a> constructors accept an <code>alpn_protocols</code> list. The list for server should be given in a descending order of preference. In the case of protocol selection, the server will iterate its list and select the first element that the client's list also advertises.</p><p>For example, if the client advertises <code>[&quot;foo&quot;; &quot;bar&quot;; &quot;baz&quot;]</code> and the server has <code>[&quot;bar&quot;; &quot;foo&quot;]</code>, <code>&quot;bar&quot;</code> will be selected as the protocol of the handshake.</p></header></section><section><header><h2 id="utility-functions"><a href="#utility-functions" class="anchor"></a>Utility functions</h2></header><dl><dt class="spec value" id="val-default_signature_algorithms"><a href="#val-default_signature_algorithms" class="anchor"></a><code><span class="keyword">val</span> default_signature_algorithms : <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></code></dt><dd><p><code>default_signature_algorithms</code> is a list of signature algorithms used by default</p></dd></dl><dl><dt class="spec value" id="val-supported_signature_algorithms"><a href="#val-supported_signature_algorithms" class="anchor"></a><code><span class="keyword">val</span> supported_signature_algorithms : <span><a href="../Core/index.html#type-signature_algorithm">Core.signature_algorithm</a> list</span></code></dt><dd><p><code>supported_signature_algorithms</code> is a list of supported signature algorithms by this library</p></dd></dl><dl><dt class="spec value" id="val-min_dh_size"><a href="#val-min_dh_size" class="anchor"></a><code><span class="keyword">val</span> min_dh_size : int</code></dt><dd><p><code>min_dh_size</code> is minimal diffie hellman group size in bits (currently 1024)</p></dd></dl><dl><dt class="spec value" id="val-supported_groups"><a href="#val-supported_groups" class="anchor"></a><code><span class="keyword">val</span> supported_groups : <span><a href="../Core/index.html#type-group">Core.group</a> list</span></code></dt><dd><p><code>supported_groups</code> are the Diffie-Hellman groups supported in this library.</p></dd></dl><dl><dt class="spec value" id="val-elliptic_curve"><a href="#val-elliptic_curve" class="anchor"></a><code><span class="keyword">val</span> elliptic_curve : <a href="../Core/index.html#type-group">Core.group</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>elliptic_curve group</code> is <code>true</code> if group is an elliptic curve, <code>false</code> otherwise.</p></dd></dl><dl><dt class="spec value" id="val-min_rsa_key_size"><a href="#val-min_rsa_key_size" class="anchor"></a><code><span class="keyword">val</span> min_rsa_key_size : int</code></dt><dd><p><code>min_rsa_key_size</code> is minimal RSA modulus key size in bits (currently 1024)</p></dd></dl><dl><dt class="spec module" id="module-Ciphers"><a href="#module-Ciphers" class="anchor"></a><code><span class="keyword">module</span> <a href="Ciphers/index.html">Ciphers</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Cipher selection</p></dd></dl></section><section><header><h2 id="internal-use-only"><a href="#internal-use-only" class="anchor"></a>Internal use only</h2></header><dl><dt class="spec value" id="val-of_client"><a href="#val-of_client" class="anchor"></a><code><span class="keyword">val</span> of_client : <a href="index.html#type-client">client</a> <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p><code>of_client client</code> is a client configuration for <code>client</code></p></dd></dl><dl><dt class="spec value" id="val-of_server"><a href="#val-of_server" class="anchor"></a><code><span class="keyword">val</span> of_server : <a href="index.html#type-server">server</a> <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p><code>of_server server</code> is a server configuration for <code>server</code></p></dd></dl><dl><dt class="spec value" id="val-with_authenticator"><a href="#val-with_authenticator" class="anchor"></a><code><span class="keyword">val</span> with_authenticator : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> X509.Authenticator.t <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p><code>with_authenticator config auth</code> is <code>config</code> with <code>auth</code> as <code>authenticator</code></p></dd></dl><dl><dt class="spec value" id="val-with_own_certificates"><a href="#val-with_own_certificates" class="anchor"></a><code><span class="keyword">val</span> with_own_certificates : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> <a href="index.html#type-own_cert">own_cert</a> <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p><code>with_own_certificates config cert</code> is <code>config</code> with <code>cert</code> as <code>own_cert</code></p></dd></dl><dl><dt class="spec value" id="val-with_acceptable_cas"><a href="#val-with_acceptable_cas" class="anchor"></a><code><span class="keyword">val</span> with_acceptable_cas : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> <span>X509.Distinguished_name.t list</span> <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p><code>with_acceptable_cas config cas</code> is <code>config</code> with <code>cas</code> as <code>accepted_cas</code></p></dd></dl></section></div></body></html>